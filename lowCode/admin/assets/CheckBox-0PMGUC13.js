import{r,j as n}from"./index-BrD5sXbN.js";import{h as j,i as v,l as k}from"./Page-xyqr89RQ.js";import{useFormContext as V}from"./context-D17HXmSO.js";import{u as W}from"./pageStore-D-Vypx31.js";import{F as A}from"./index-CiNuIwYW.js";import"./util-DHOYMMeV.js";import"./DoubleRightOutlined-BBqvPxX4.js";import"./index-BTJ7lNGW.js";import"./tslib.es6-DQF7CiZa.js";import"./index-QqHQ6VDD.js";import"./index-D8qpNAOl.js";import"./index-F3O87iVt.js";const F=({type:x,config:e,onChange:o},c)=>{var d;const[y,m]=r.useState([]),[h,u]=r.useState(!0),[D,l]=r.useState(),{initValues:E}=V(),I=W(a=>a.page.pageData.variableData);r.useEffect(()=>{var s;const a=(s=e.props.formItem)==null?void 0:s.name,t=e.props.defaultValue||[];E(x,a,t)},[JSON.stringify(e.props.defaultValue)]),r.useEffect(()=>{typeof e.props.formWrap.disabled=="boolean"&&l(e.props.formWrap.disabled)},[e.props.formWrap.disabled]),r.useEffect(()=>{i({})},[e.api,((d=e.api)==null?void 0:d.sourceType)=="variable"?I:""]);const i=a=>{j(e.api,a).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[checkbox]","data数据格式错误，请检查"),m([]);else{let s=[];e.props.field.label==="label"&&e.props.field.value==="value"?(s=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(s=t.data.map(p=>({label:p,value:p})))):s=t.data.map(p=>{const b=p[e.props.field.label||"label"],f=p[e.props.field.value||"value"];return{label:v(b)?b:"-",value:v(f)?f:""}}),m(s)}})};r.useImperativeHandle(c,()=>({show(){u(!0)},hide(){u(!1)},enable(){l(!1)},disable(){l(!0)},update:a=>{i(a)}}));const S=a=>{o==null||o({[e.props.formItem.name]:a})};return h&&n.jsx(A.Item,{...e.props.formItem,children:n.jsx(k.Group,{...e.props.formWrap,disabled:D,options:y,style:e.style,onChange:a=>S(a)})})},T=r.forwardRef(F);export{T as default};
