import{r as p,j as n,B as y}from"./index-DzwVQ2UK.js";import{h as w,y as B,i as C,f as d,z as f,T as h,I as N,E as m,e as E}from"./Page-B4H8Li0A.js";import{u as F}from"./pageStore-CahLOgRM.js";import{T as b}from"./index-ytCQesj7.js";import"./util-D3GCZG9x.js";import"./DoubleRightOutlined-oEBZ4Nyz.js";import"./index-Cr1Ff2Du.js";import"./index-Bvso4piW.js";import"./tslib.es6-TvfGtUkn.js";import"./index-Ce96gYJJ.js";import"./index-Bz8JGjyY.js";const M=({id:j,type:k,config:s},D)=>{var u;const[S,l]=p.useState(!0),[i,t]=p.useState([]),g=F(e=>e.page.pageData.variableData);p.useEffect(()=>{v({})},[s.api,((u=s.api)==null?void 0:u.sourceType)=="variable"?g:""]);const v=e=>{w(s.api,e).then(r=>{(r==null?void 0:r.code)===0&&(Array.isArray(r.data)?t(r.data):t([r.data]))})};p.useImperativeHandle(D,()=>({show(){l(!0)},hide(){l(!1)}}));const c=(e,r)=>{const o=s.events.find(a=>a.eventName===e);E(o==null?void 0:o.actions,r)},A=(e,r,o)=>{if(C(e)?r.type==="money"?e=d(e,"currency"):r.type==="number"?e=d(e):r.type==="date1"?e=f(e,"YYYY-MM-DD"):r.type==="date2"&&(e=f(e)):typeof s.props.empty>"u"?e="-":s.props.empty&&(e=s.props.empty),r.render)try{e=new Function("text","record",`return (${r.render})(text,record);`)(e,o)}catch(a){console.error(`列[${r.title}]渲染失败`,a),e="解析异常"}if(r.type==="text"){const a=n.jsx(y,{type:"link",onClick:()=>c(r.eventName,o),children:e.toString()});return r.ellipsis&&r.copyable?n.jsx(b,{title:e,children:n.jsx(h.Paragraph,{copyable:!0,style:{marginBottom:0},children:r.clickable?a:e.toString()})}):r.ellipsis?n.jsx(b,{title:e,children:r.clickable?a:e.toString()}):r.copyable?n.jsx(h.Paragraph,{copyable:!0,children:r.clickable?a:e.toString()}):r.clickable?n.jsx(y,{type:"link",onClick:()=>c(r.eventName,o),children:e.toString()}):e.toString()}return r.type==="image"?n.jsx(N,{src:e,width:30}):r.type==="tag"?Array.isArray(e)?e.map(a=>n.jsx(m,{children:a},a)):typeof e=="string"||typeof e=="number"?n.jsx(m,{children:e}):e==null?void 0:e.toString():e},T=p.useMemo(()=>s.props.items.map(e=>{var a;const r=((a=i[0])==null?void 0:a[e.name])||"",o=A(r,e,i[0]||{});return{key:e.key,label:e.label,children:o,span:e.span}}),[s.props.items,i]);return S&&n.jsx(B,{...s.props,items:T,"data-id":j,"data-type":k,style:s.style})},J=p.forwardRef(M);export{J as default};
