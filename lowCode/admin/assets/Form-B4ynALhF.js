import{r as i,j as p}from"./index-BrD5sXbN.js";import{u as P}from"./util-DHOYMMeV.js";import{a as c,i as R,g as h,b as w,d as S,M as E}from"./Page-xyqr89RQ.js";import{FormContext as H}from"./context-D17HXmSO.js";import{u as I}from"./pageStore-D-Vypx31.js";import{F as D}from"./index-CiNuIwYW.js";import"./DoubleRightOutlined-BBqvPxX4.js";import"./index-BTJ7lNGW.js";import"./tslib.es6-DQF7CiZa.js";import"./index-QqHQ6VDD.js";import"./index-D8qpNAOl.js";import"./index-F3O87iVt.js";const M=({id:o,config:f,elements:m,onFinish:l,onChange:n},V)=>{const[a]=D.useForm(),{formData:d,setFormData:u}=I(P(t=>({formData:t.page.pageData.formData,setFormData:t.setFormData}))),[b,F]=i.useState(!0),[g,v]=i.useState({}),x=t=>{l==null||l(c(m,t))},y=(t,e)=>{const r=c(m,e);n==null||n(r),u({name:o,value:r})};i.useImperativeHandle(V,()=>({show(){F(!0)},hide(){F(!1)},reset(){a.resetFields(),u({name:o,value:a.getFieldsValue(),type:"override"})},submit(){a.submit()},async validate(){try{return await a.validateFields(),!0}catch(t){return console.error(t),!1}},init(t={}){const e=c(m,t);a.setFieldsValue(e),u({name:o,value:e,type:"override"})},getFormData(t){var e;return t&&typeof t=="string"?(e=d[o])==null?void 0:e[t]:d[o]}}));const j=i.useCallback((t,e,r)=>{if(e&&R(r)){let s=r;t==="InputNumber"&&(s=Number(r)),t==="DatePicker"&&(s=h(r)),t==="DatePickerRange"&&(s=w(r)),t==="TimePicker"&&(s=S(r,"HH:mm:ss")),v({[e]:s}),a.setFieldValue([e],s),u({name:o,value:{[e]:s}})}},[]);return b&&p.jsx(H.Provider,{value:{initValues:j},children:p.jsx(D,{form:a,style:f.style,...f.props,initialValues:g,onFinish:x,onValuesChange:y,children:p.jsx(E,{elements:m})})})},K=i.memo(i.forwardRef(M));export{K as default};
