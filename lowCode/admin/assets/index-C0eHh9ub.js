import{b as h,u as f,j as o,B as v,r as u,c as D,s as N,g as S,m as b}from"./index-BrD5sXbN.js";import{u as E}from"./pageStore-D-Vypx31.js";import{u as F}from"./projectStore-CIftHt1D.js";import{R as y}from"./index-D8qpNAOl.js";import{P as B}from"./Page-xyqr89RQ.js";import{u as l,g as R,i as k}from"./util-DHOYMMeV.js";import"./index-F3O87iVt.js";import"./index-BTJ7lNGW.js";import"./index-CiNuIwYW.js";import"./index-QqHQ6VDD.js";import"./DoubleRightOutlined-BBqvPxX4.js";import"./tslib.es6-DQF7CiZa.js";function w(){const t=h(),{projectId:s}=f(),r=()=>{t(`/project/${s}/welcome`)};return o.jsx(y,{status:404,title:"页面不存在或未发布",subTitle:"当前页面路径不存在，请检查路由地址是否正确或页面是否发布",extra:o.jsx(v,{type:"primary",onClick:r,children:"返回首页"})})}function K(){const[t,s]=u.useState(),[r,n]=u.useState(!1),{projectId:a}=f();console.log(a);const{initPageData:P,savePageInfo:d,clearPageInfo:j}=E(l(e=>({initPageData:e.page.pageData,savePageInfo:e.savePageInfo,clearPageInfo:e.clearPageInfo}))),p=F(l(e=>e.pageMap)),{pathname:m}=D();return u.useEffect(()=>{if(!a)return;let e=N.get(`${a}-env`)||"prd";const x=m.split(a)[1].slice(1),i=R(x,p);if(!p[i]||!i){n(!0);return}return k(e)||(e="prd"),S(e,Number(a),Number(i)).then(c=>{let g={};try{g=JSON.parse(c.pageData||"{}")}catch(I){console.error(I),console.info("【json数据】",c.pageData),b.error("页面数据格式错误，请检查")}j(),d({...c,pageData:g}),s(g),n(!1)}).catch(()=>{n(!0)}),()=>{s({config:P.config,elements:[]})}},[a,m]),o.jsx(o.Fragment,{children:r?o.jsx(w,{}):o.jsx(B,{config:t==null?void 0:t.config,elements:t==null?void 0:t.elements})})}export{K as default};
