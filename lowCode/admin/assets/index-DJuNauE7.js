import{b as h,u as l,j as a,B as v,r as g,c as D,s as N,g as S,m as b}from"./index-DzwVQ2UK.js";import{u as E}from"./pageStore-CahLOgRM.js";import{u as F}from"./projectStore-GWkWPqkJ.js";import{R as y}from"./index-Ce96gYJJ.js";import{P as B}from"./Page-B4H8Li0A.js";import{u as f,g as R,i as k}from"./util-D3GCZG9x.js";import"./index-Bz8JGjyY.js";import"./index-ytCQesj7.js";import"./index-Cr1Ff2Du.js";import"./index-Bvso4piW.js";import"./DoubleRightOutlined-oEBZ4Nyz.js";import"./tslib.es6-TvfGtUkn.js";function w(){const t=h(),{projectId:r}=l(),s=()=>{t(`/project/${r}/welcome`)};return a.jsx(y,{status:404,title:"页面不存在或未发布",subTitle:"当前页面路径不存在，请检查路由地址是否正确或页面是否发布",extra:a.jsx(v,{type:"primary",onClick:s,children:"返回首页"})})}function K(){const[t,r]=g.useState(),[s,n]=g.useState(!1),{projectId:o}=l(),{initPageData:P,savePageInfo:d,clearPageInfo:j}=E(f(e=>({initPageData:e.page.pageData,savePageInfo:e.savePageInfo,clearPageInfo:e.clearPageInfo}))),p=F(f(e=>e.pageMap)),{pathname:m}=D();return g.useEffect(()=>{if(!o)return;let e=N.get(`${o}-env`)||"prd";const x=m.split(o)[1].slice(1),i=R(x,p);if(!p[i]||!i){n(!0);return}return k(e)||(e="prd"),S(e,Number(o),Number(i)).then(c=>{let u={};try{u=JSON.parse(c.pageData||"{}")}catch(I){console.error(I),console.info("【json数据】",c.pageData),b.error("页面数据格式错误，请检查")}j(),d({...c,pageData:u}),r(u),n(!1)}).catch(()=>{n(!0)}),()=>{r({config:P.config,elements:[]})}},[o,m]),a.jsx(a.Fragment,{children:s?a.jsx(w,{}):a.jsx(B,{config:t==null?void 0:t.config,elements:t==null?void 0:t.elements})})}export{K as default};
