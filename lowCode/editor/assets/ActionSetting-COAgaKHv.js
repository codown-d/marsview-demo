import{r as u,a as y,j as e,E as I,k as A,dl as R,i as S,B as N,N as L}from"./index-DmOc0qNU.js";import{u as M}from"./index-CrdplzP2.js";import{i as k}from"./index-C3QLbPSd.js";import{V}from"./VariableBind-alrlGhmD.js";import{F as l}from"./index-1_6nT-oA.js";import{M as w}from"./index-_pMv_sKm.js";import{I as x}from"./index-B-YUPJxN.js";import{R as T}from"./index-DxJl0Bxc.js";import{S as C}from"./index-DSaINUG7.js";import{R as O}from"./EditOutlined-D6nYSc60.js";import{R as P}from"./MinusOutlined-Cj88Lgeh.js";import{R as B}from"./PlusOutlined-BSTEPWl7.js";const D=u.memo(r=>{const[a,c]=u.useState(!1),[h,j]=u.useState(0),[d]=l.useForm(),{selectedElement:o,elementsMap:b,editTableProps:v}=y(t=>({selectedElement:t.selectedElement,elementsMap:t.page.pageData.elementsMap,editTableProps:t.editTableProps}));u.useImperativeHandle(r.modalRef,()=>({open(t){const i=b[o==null?void 0:o.id];d.setFieldsValue({danger:!1,...i.config.props.bulkActionList[t]}),j(t),c(!0)}}));const g=()=>{d.validateFields().then(()=>{const t=d.getFieldsValue();v({id:o==null?void 0:o.id,type:"bulkActionList",index:h,props:t}),r.update(t,h),c(!1)})},f=()=>{c(!1)},n=k;return e.jsx(w,{title:"操作按钮设置",open:a,onOk:g,onCancel:f,width:600,destroyOnClose:!0,children:e.jsxs(l,{form:d,labelCol:{span:5},wrapperCol:{span:18},children:[e.jsx(l.Item,{label:"按钮名称",name:"text",rules:[{required:!0,message:"请输入按钮名称"}],children:e.jsx(x,{})}),e.jsx(l.Item,{name:"eventName",hidden:!0,children:e.jsx(x,{})}),e.jsx(l.Item,{label:"按钮类型",name:"type",children:e.jsx(T.Group,{optionType:"button",buttonStyle:"solid",options:[{label:"主按钮",value:"primary"},{label:"默认",value:"default"},{label:"虚线按钮",value:"dashed"},{label:"文本按钮",value:"text"},{label:"链接按钮",value:"link"}]})}),e.jsx(l.Item,{label:"危险按钮",name:"danger",valuePropName:"checked",children:e.jsx(I,{})}),e.jsx(l.Item,{label:"块状按钮",name:"block",valuePropName:"checked",children:e.jsx(I,{})}),e.jsx(l.Item,{label:"按钮图标",name:"icon",children:e.jsx(C,{placeholder:"请选择菜单图表",showSearch:!0,allowClear:!0,children:Object.keys(k).filter(t=>!["default","createFromIconfontCN","getTwoToneColor","setTwoToneColor","IconProvider"].includes(t)).map(t=>e.jsx(C.Option,{value:t,children:A.createElement(n[t],{style:{fontSize:"24px",verticalAlign:"middle"}})},t))})}),e.jsx(l.Item,{name:"authCode",label:"权限标识",children:e.jsx(x,{})}),e.jsx(l.Item,{name:"authScript",label:"三方脚本",children:e.jsx(V,{})})]})})}),Y=u.memo(({form:r})=>{const{selectedElement:a,elementsMap:c,editEvents:h}=y(n=>({selectedElement:n.selectedElement,elementsMap:n.page.pageData.elementsMap,editEvents:n.editEvents})),j=u.useRef(),d=n=>{n({text:"下载",type:"primary",eventName:L("BulkAction")}),b()},o=(n,t)=>{n(t),b()},b=()=>{var i,m;const t=(i=c[a==null?void 0:a.id].events)==null?void 0:i.filter(s=>s.value.indexOf("BulkAction")==-1);(m=r.getFieldValue("bulkActionList"))==null||m.map(s=>{t.push({name:s.text+"事件",value:s.eventName})}),h({id:a==null?void 0:a.id,events:t})},v=n=>{var t;(t=j.current)==null||t.open(n)},{run:g}=M((n,t)=>{f(n,t)},{wait:500}),f=(n,t)=>{typeof n=="string"?r.setFieldValue(["bulkActionList",t,"text"],n):r.setFieldValue(["bulkActionList",t],n);const i=r.getFieldValue(["bulkActionList",t,"eventName"]),m=c[a==null?void 0:a.id],s=R(m.events);s.map(p=>(p.value===i&&(typeof n=="string"?p.name=n+"事件":p.name=n.text+"事件"),p)),h({id:a==null?void 0:a.id,events:s})};return e.jsxs(e.Fragment,{children:[e.jsx(l.List,{name:["bulkActionList"],children:(n,{add:t,remove:i})=>e.jsxs(e.Fragment,{children:[n.map(({key:m,name:s,...p})=>e.jsxs(S,{align:"baseline",children:[e.jsx(l.Item,{...p,labelCol:{span:12},name:[s,"text"],label:"按钮",children:e.jsx(x,{placeholder:"请输入按钮名称",onChange:F=>g(F.target.value,s)})}),e.jsx(l.Item,{name:[s,"eventName"],hidden:!0,children:e.jsx(x,{})}),e.jsx(l.Item,{name:[s,"type"],hidden:!0,children:e.jsx(x,{})}),e.jsx(O,{onClick:()=>v(s)}),e.jsx(P,{onClick:()=>o(i,s)})]},m)),e.jsx("div",{style:{padding:"0 10px 10px"},children:e.jsx(N,{type:"primary",block:!0,ghost:!0,onClick:()=>d(t),icon:e.jsx(B,{}),children:"新增"})})]})}),e.jsx(D,{modalRef:j,update:f})]})});export{Y as A};
