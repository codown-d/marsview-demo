import{j as e,i as v,r as l,a as g,ah as y,B as f}from"./index-CY1Ymj4r.js";import{S as k}from"./SettingModal-B-iGUT5G.js";import{V as h}from"./VsEditor-Bn3NW5Dw.js";import{V as R}from"./VariableBind-g8cMkMZP.js";import{F as n}from"./index-BKDg-K48.js";import{I as j}from"./index-Du8QL6nv.js";import{R as I}from"./PlusOutlined-dRNvmZ2Y.js";import{R as b}from"./NotificationOutlined-C3CDmrw2.js";import{T as F}from"./index-BnlvMKaU.js";import{M}from"./index-ClLmsWSS.js";import{R as w}from"./SettingOutlined-B7WTL30f.js";import{L as x}from"./index-BX8mFvI3.js";import"./index-CrCWvzoA.js";import"./index-CVwKh-ii.js";import"./InfoCircleOutlined-DWZ7nUzE.js";import"./index-Tz3gITLY.js";import"./util-UBnOudtO.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./index-BpGeudkR.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./index-BqJLt5d9.js";import"./List-CfIaGhIa.js";import"./conductUtil-oPofkrzY.js";import"./PlusSquareOutlined-D3cnUxWk.js";import"./FolderOpenOutlined-CDyAvlLT.js";import"./HolderOutlined-E1hrqN51.js";import"./index-CMyR3-Rp.js";import"./DownOutlined-QYs-kCMH.js";import"./FunctionOutlined-D3UO96Yh.js";import"./row-C5ps4gU6.js";import"./index-C1u3Ql-g.js";import"./BaseInput-Bka7TPzR.js";import"./TextArea-U5uDgpR6.js";import"./useVariants-B4R8rkTL.js";import"./EyeInvisibleOutlined-DDX5Jvzv.js";import"./EyeOutlined-B6CobvGR.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./UpOutlined-Bu3BOxje.js";import"./extendsObject-keMuGWqj.js";import"./useShowArrow-C9phI0pM.js";import"./index-DYezmHfp.js";import"./useIcons-CYuILU2n.js";import"./useBreakpoint-D-Sgac-T.js";import"./useForceUpdate-BsEHW89a.js";import"./Pagination-BhehRHa0.js";import"./DoubleRightOutlined-BcWxf5hS.js";import"./index-CUKOry-Y.js";const C=function(){return e.jsxs(e.Fragment,{children:[e.jsx(n.Item,{label:"请求头",children:e.jsx(n.List,{name:"headers",children:(s,{add:a,remove:m})=>e.jsx(e.Fragment,{children:s.map(({name:i},r)=>e.jsxs(v,{align:"center",style:{marginBottom:s.length===r+1?0:10},children:[e.jsx(n.Item,{name:[i,"key"],noStyle:!0,children:e.jsx(j,{placeholder:"请输入Key"})}),e.jsx(n.Item,{name:[i,"value"],noStyle:!0,children:e.jsx(R,{placeholder:"请输入Value"})}),e.jsx(I,{onClick:()=>a({key:"",value:""})}),r>0&&e.jsx(b,{onClick:()=>{m(i)}})]},`header-${r}`))})})}),e.jsx(n.Item,{label:"超时时间",name:"timeout",children:e.jsx(F,{addonAfter:"秒"})}),e.jsx(n.Item,{label:"超时提示",name:"timeoutErrorMessage",children:e.jsx(j,{placeholder:"请输入超时提示"})}),e.jsx(n.Item,{label:"请求适配",name:"requestInterceptor",children:e.jsx(h,{})}),e.jsx(n.Item,{label:"返回适配",name:"responseInterceptor",children:e.jsx(h,{})})]})},S=({update:s},a)=>{const{interceptor:m,setInterceptor:i}=g(p=>({interceptor:p.page.pageData.interceptor,setInterceptor:p.setInterceptor})),[r]=n.useForm(),[d,c]=l.useState(!1),u={headers:[{key:"",value:""}],timeout:8,timeoutErrorMessage:"请求超时，请稍后重试",requestInterceptor:`/**
 * config: 请求完整配置，请严格按照以下格式使用和返回
 * config.url: 请求地址,eg: config.url = 'https://xxx.marsview.com.cn/api/xxx'
 * config.params: Get请求对应参数,eg: config.params = {name:'xxx'}
 * config.data: Post请求对应数据,eg: config.data = {name:'xxx'}
 * config.timeout: 超时时间（秒）,eg: config.timeout = 5
 * config.headers: 请求头,eg: config.headers.token = 'xxx'
 */
function request(config){
    return config;
}`,responseInterceptor:`/**
* response: 返回值完整结构
* response.config: 请求完整配置。
* response.data: 请求返回数据
* response.headers: 请求头
* response.status: 请求状态码
*/
function response(response){
    return response;
}`};l.useImperativeHandle(a,()=>({showModal:()=>{r.setFieldsValue({...u,...m}),c(!0)}}));async function t(){await r.validateFields()&&(i(r.getFieldsValue()),o())}function o(){c(!1),r.resetFields()}return e.jsx(M,{width:"800px",okText:"确认",cancelText:"取消",title:"高级设置",open:d,onOk:t,onCancel:o,children:e.jsx(n,{form:r,labelCol:{span:4},wrapperCol:{span:19},style:{maxWidth:800},autoComplete:"off",children:e.jsx(C,{})})})},V=l.forwardRef(S),Fe=()=>{const s=l.useRef(),a=l.useRef(),{apis:m,removeApi:i}=g(t=>({apis:t.page.pageData.apis,removeApi:t.removeApi})),r=()=>{var t;(t=s.current)==null||t.showModal()},d=(t,o)=>{var p;t.preventDefault(),(p=s.current)==null||p.showModal(o.id)},c=(t,o)=>{t.preventDefault(),i(o)},u=()=>{var t;(t=a.current)==null||t.showModal()};return e.jsxs(e.Fragment,{children:[e.jsxs(y,{justify:"space-between",align:"center",style:{borderBottom:"1px solid var(--mars-theme-card-border-color)"},children:[e.jsx(f,{type:"link",icon:e.jsx(I,{}),onClick:()=>r(),children:"新增"}),e.jsx(f,{type:"link",icon:e.jsx(w,{}),onClick:()=>u(),children:"全局拦截器"})]}),e.jsx(x,{style:{height:"calc(100vh - 150px)",overflowY:"auto"},itemLayout:"horizontal",dataSource:Object.values(m),renderItem:t=>e.jsx(x.Item,{actions:[e.jsx("a",{onClick:o=>d(o,t),children:"修改"}),e.jsx("a",{onClick:o=>c(o,t.id),children:"删除"})],children:e.jsx(x.Item.Meta,{title:`${t.method} ${t.name}`,description:t.url})})}),e.jsx(k,{ref:s}),e.jsx(V,{ref:a})]})};export{Fe as default};
