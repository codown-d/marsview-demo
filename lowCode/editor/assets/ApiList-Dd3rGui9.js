import{j as e,i as v,r as l,a as g,ah as y,B as f}from"./index-DmOc0qNU.js";import{S as k}from"./SettingModal-DRclkpPm.js";import{V as h}from"./VsEditor-DbAzcx7k.js";import{V as R}from"./VariableBind-alrlGhmD.js";import{F as n}from"./index-1_6nT-oA.js";import{I as j}from"./index-B-YUPJxN.js";import{R as I}from"./PlusOutlined-BSTEPWl7.js";import{R as b}from"./NotificationOutlined-DlRBMYlM.js";import{T as F}from"./index-o7l-rjNw.js";import{M}from"./index-_pMv_sKm.js";import{R as w}from"./SettingOutlined-CGW_ik-t.js";import{L as x}from"./index-CW6BFuNZ.js";import"./index-DxJl0Bxc.js";import"./index-B5-G8EA2.js";import"./InfoCircleOutlined-D9lj3ic_.js";import"./index-Dg1x3Ybx.js";import"./util-DNkFm-j2.js";import"./index-C0E5Fhz-.js";import"./_baseGet-xRkAGEE7.js";import"./index-sNbwzaq7.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./index-B6d_3ZHh.js";import"./List-BV6fBbjc.js";import"./conductUtil-wNhCxpcs.js";import"./PlusSquareOutlined-D0i2U-a9.js";import"./FolderOpenOutlined-Bj6jPccg.js";import"./HolderOutlined-CzOeoeCY.js";import"./index-B2mTmS5H.js";import"./DownOutlined-DnWdyoG8.js";import"./FunctionOutlined-Dm0pzJNb.js";import"./row-pIc0FM19.js";import"./index-DOHCQObp.js";import"./BaseInput-4F0kfgVN.js";import"./TextArea-D7VuO_-I.js";import"./useVariants-BdxfBOl3.js";import"./EyeInvisibleOutlined-Cl_PTdo5.js";import"./EyeOutlined-QFSiY36E.js";import"./SearchOutlined-DscCkqW9.js";import"./UpOutlined-CkYvBYD1.js";import"./extendsObject-keMuGWqj.js";import"./useShowArrow-CIjY5B73.js";import"./index-wVmnK_0F.js";import"./useIcons-CLAJNkrF.js";import"./useBreakpoint-Dj2PHoq7.js";import"./useForceUpdate-Y5LXbfsE.js";import"./Pagination-B_kLQQfV.js";import"./DoubleRightOutlined-FRvrxn3q.js";import"./index-DSaINUG7.js";const C=function(){return e.jsxs(e.Fragment,{children:[e.jsx(n.Item,{label:"请求头",children:e.jsx(n.List,{name:"headers",children:(s,{add:a,remove:m})=>e.jsx(e.Fragment,{children:s.map(({name:i},r)=>e.jsxs(v,{align:"center",style:{marginBottom:s.length===r+1?0:10},children:[e.jsx(n.Item,{name:[i,"key"],noStyle:!0,children:e.jsx(j,{placeholder:"请输入Key"})}),e.jsx(n.Item,{name:[i,"value"],noStyle:!0,children:e.jsx(R,{placeholder:"请输入Value"})}),e.jsx(I,{onClick:()=>a({key:"",value:""})}),r>0&&e.jsx(b,{onClick:()=>{m(i)}})]},`header-${r}`))})})}),e.jsx(n.Item,{label:"超时时间",name:"timeout",children:e.jsx(F,{addonAfter:"秒"})}),e.jsx(n.Item,{label:"超时提示",name:"timeoutErrorMessage",children:e.jsx(j,{placeholder:"请输入超时提示"})}),e.jsx(n.Item,{label:"请求适配",name:"requestInterceptor",children:e.jsx(h,{})}),e.jsx(n.Item,{label:"返回适配",name:"responseInterceptor",children:e.jsx(h,{})})]})},S=({update:s},a)=>{const{interceptor:m,setInterceptor:i}=g(p=>({interceptor:p.page.pageData.interceptor,setInterceptor:p.setInterceptor})),[r]=n.useForm(),[d,c]=l.useState(!1),u={headers:[{key:"",value:""}],timeout:8,timeoutErrorMessage:"请求超时，请稍后重试",requestInterceptor:`/**
 * config: 请求完整配置，请严格按照以下格式使用和返回
 * config.url: 请求地址,eg: config.url = 'https://xxx.marsview.com.cn/api/xxx'
 * config.params: Get请求对应参数,eg: config.params = {name:'xxx'}
 * config.data: Post请求对应数据,eg: config.data = {name:'xxx'}
 * config.timeout: 超时时间（秒）,eg: config.timeout = 5
 * config.headers: 请求头,eg: config.headers.token = 'xxx'
 */
function request(config){
    return config;
}`,responseInterceptor:`/**
* response: 返回值完整结构
* response.config: 请求完整配置。
* response.data: 请求返回数据
* response.headers: 请求头
* response.status: 请求状态码
*/
function response(response){
    return response;
}`};l.useImperativeHandle(a,()=>({showModal:()=>{r.setFieldsValue({...u,...m}),c(!0)}}));async function t(){await r.validateFields()&&(i(r.getFieldsValue()),o())}function o(){c(!1),r.resetFields()}return e.jsx(M,{width:"800px",okText:"确认",cancelText:"取消",title:"高级设置",open:d,onOk:t,onCancel:o,children:e.jsx(n,{form:r,labelCol:{span:4},wrapperCol:{span:19},style:{maxWidth:800},autoComplete:"off",children:e.jsx(C,{})})})},V=l.forwardRef(S),Fe=()=>{const s=l.useRef(),a=l.useRef(),{apis:m,removeApi:i}=g(t=>({apis:t.page.pageData.apis,removeApi:t.removeApi})),r=()=>{var t;(t=s.current)==null||t.showModal()},d=(t,o)=>{var p;t.preventDefault(),(p=s.current)==null||p.showModal(o.id)},c=(t,o)=>{t.preventDefault(),i(o)},u=()=>{var t;(t=a.current)==null||t.showModal()};return e.jsxs(e.Fragment,{children:[e.jsxs(y,{justify:"space-between",align:"center",style:{borderBottom:"1px solid var(--mars-theme-card-border-color)"},children:[e.jsx(f,{type:"link",icon:e.jsx(I,{}),onClick:()=>r(),children:"新增"}),e.jsx(f,{type:"link",icon:e.jsx(w,{}),onClick:()=>u(),children:"全局拦截器"})]}),e.jsx(x,{style:{height:"calc(100vh - 150px)",overflowY:"auto"},itemLayout:"horizontal",dataSource:Object.values(m),renderItem:t=>e.jsx(x.Item,{actions:[e.jsx("a",{onClick:o=>d(o,t),children:"修改"}),e.jsx("a",{onClick:o=>c(o,t.id),children:"删除"})],children:e.jsx(x.Item.Meta,{title:`${t.method} ${t.name}`,description:t.url})})}),e.jsx(k,{ref:s}),e.jsx(V,{ref:a})]})};export{Fe as default};
