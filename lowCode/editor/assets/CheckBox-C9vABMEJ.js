import{r,a as k,j as v}from"./index-CY1Ymj4r.js";import{handleApi as V}from"./handleApi-Bz3x1xZ4.js";import{i as x}from"./util-UBnOudtO.js";import{useFormContext as W}from"./context-lPMLs1NY.js";import{F as A}from"./index-BKDg-K48.js";import{C}from"./index-B5fUo_Hm.js";import"./request-K5LtYnQH.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./row-C5ps4gU6.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./index-CVwKh-ii.js";import"./index-CMyR3-Rp.js";const F=({id:c,type:m,config:a,onChange:o},y)=>{var b;const[h,i]=r.useState([]),[D,d]=r.useState(!0),[E,l]=r.useState(),{initValues:I}=W(),S=k(e=>e.page.pageData.variableData);r.useEffect(()=>{var s;const e=(s=a.props.formItem)==null?void 0:s.name,t=a.props.defaultValue||[];I(m,e,t)},[JSON.stringify(a.props.defaultValue)]),r.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&l(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),r.useEffect(()=>{u({})},[a.api,((b=a.api)==null?void 0:b.sourceType)=="variable"?S:""]);const u=e=>{V(a.api,e).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[checkbox]","data数据格式错误，请检查"),i([]);else{let s=[];a.props.field.label==="label"&&a.props.field.value==="value"?(s=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(s=t.data.map(p=>({label:p,value:p})))):s=t.data.map(p=>{const f=p[a.props.field.label||"label"],n=p[a.props.field.value||"value"];return{label:x(f)?f:"-",value:x(n)?n:""}}),i(s)}})};r.useImperativeHandle(y,()=>({show(){d(!0)},hide(){d(!1)},enable(){l(!1)},disable(){l(!0)},update:e=>{u(e)}}));const j=e=>{o==null||o({[a.props.formItem.name]:e})};return D&&v.jsx(A.Item,{...a.props.formItem,"data-id":c,"data-type":m,children:v.jsx(C.Group,{...a.props.formWrap,disabled:E,options:h,style:a.style,onChange:e=>j(e)})})},z=r.forwardRef(F);export{z as default};
