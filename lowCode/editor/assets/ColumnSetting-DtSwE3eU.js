import{r as u,a as H,j as e,ah as g,T as v,E as y,B as V,N as M}from"./index-CY1Ymj4r.js";import{u as J,F as t}from"./index-BKDg-K48.js";import{V as $}from"./VsEditor-Bn3NW5Dw.js";import{V as E}from"./VariableBind-g8cMkMZP.js";import{M as L}from"./index-ClLmsWSS.js";import{T as K}from"./index-Tz3gITLY.js";import{R as b,C as s}from"./row-C5ps4gU6.js";import{I as x}from"./index-Du8QL6nv.js";import{T as S}from"./index-BnlvMKaU.js";import{R as c}from"./index-CrCWvzoA.js";import{S as r}from"./index-CUKOry-Y.js";import{R as I}from"./QuestionCircleOutlined-TTJW15q1.js";import{C as Q}from"./index-DBtJBM7q.js";import{R as W}from"./NotificationOutlined-C3CDmrw2.js";import{R as X}from"./PlusOutlined-dRNvmZ2Y.js";import"./util-UBnOudtO.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./index-BpGeudkR.js";import"./index-BqJLt5d9.js";import"./List-CfIaGhIa.js";import"./conductUtil-oPofkrzY.js";import"./PlusSquareOutlined-D3cnUxWk.js";import"./FolderOpenOutlined-CDyAvlLT.js";import"./HolderOutlined-E1hrqN51.js";import"./index-CMyR3-Rp.js";import"./DownOutlined-QYs-kCMH.js";import"./FunctionOutlined-D3UO96Yh.js";import"./index-C1u3Ql-g.js";import"./BaseInput-Bka7TPzR.js";import"./TextArea-U5uDgpR6.js";import"./useVariants-B4R8rkTL.js";import"./EyeInvisibleOutlined-DDX5Jvzv.js";import"./EyeOutlined-B6CobvGR.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./UpOutlined-Bu3BOxje.js";import"./index-CVwKh-ii.js";import"./useShowArrow-C9phI0pM.js";import"./index-DYezmHfp.js";import"./useIcons-CYuILU2n.js";const qe=u.memo(a=>{const[p,j]=u.useState(!1),[h,C]=u.useState(0),[k,F]=u.useState(""),[n]=J(),{selectedElement:i,elementsMap:N,editTableProps:P,editEvents:D}=H(l=>({selectedElement:l.selectedElement,elementsMap:l.page.pageData.elementsMap,editTableProps:l.editTableProps,editEvents:l.editEvents}));u.useImperativeHandle(a.columnRef,()=>({open(l){const o=N[i==null?void 0:i.id].config.props.columns[l],m=o.render||`function render(text, record, index) {
    return text;
}`;n.resetFields(),n.setFieldsValue({align:"center",fixed:!1,type:"text",empty:"-",...o,render:m,onCell:o.onCell||`function onCell(record, index) {
    // 此处可以设置数据跨行、跨列
    return {

    }
}`}),C(l),F(`列设置 - ${o.title||""}(${(o==null?void 0:o.dataIndex)||""})`),j(!0)}}));const U=u.useMemo(()=>[{key:"basic",label:"基础配置",children:e.jsx(Y,{})},{key:"display",label:"展示配置",forceRender:!0,children:e.jsx(Z,{})},{key:"custom",label:"自定义",forceRender:!0,children:e.jsx(_,{})}],[]),q=()=>{n.validateFields().then(()=>{var w,O;const l=n.getFieldsValue(),f=N[i==null?void 0:i.id],o=M(`ClickCell${l.dataIndex}`);l.clickable?l.eventName=l.eventName||o:l.eventName="",P({id:i==null?void 0:i.id,type:"column",index:h,props:{...l,key:l.dataIndex||h}});let m=(w=f.events)==null?void 0:w.filter(d=>d.value.indexOf("Dynamic")==-1);(O=l.list)==null||O.map((d,z)=>{var B,T;let R="";typeof d.text=="string"||((B=d.text)==null?void 0:B.type)==="static"?R="点击"+(((T=d.text)==null?void 0:T.value)||d.text)+"事件":R=`操作列动态按钮${z+1}事件`,m.push({name:R,value:d.eventName})});const G=f.config.props.columns[h].eventName;m=m.filter(d=>d.value!=G),l.clickable&&m.push({name:`列${l.title}事件`,value:l.eventName||o}),D({id:f.id,events:m}),a.update(l,h),j(!1)})},A=()=>{j(!1)};return e.jsx(L,{title:k,open:p,onOk:q,onCancel:A,width:900,children:e.jsx(t,{form:n,labelCol:{span:6},children:e.jsx(K,{items:U})})})}),Y=()=>e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"列头",name:"title",rules:[{required:!0,message:"请输入列名"}],children:e.jsx(x,{})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"字段",name:"dataIndex",rules:[{required:!0,message:"请输入字段名称"}],children:e.jsx(x,{})})})]}),e.jsxs(b,{children:[e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"宽度",name:"width",children:e.jsx(S,{placeholder:"eg: 100"})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"对齐",name:"align",children:e.jsxs(c.Group,{buttonStyle:"solid",children:[e.jsx(c.Button,{value:"left",children:"居左"}),e.jsx(c.Button,{value:"center",children:"居中"}),e.jsx(c.Button,{value:"right",children:"居右"})]})})})]}),e.jsxs(b,{children:[e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"固定方式",name:"fixed",children:e.jsxs(c.Group,{buttonStyle:"solid",children:[e.jsx(c.Button,{value:"",children:"默认"}),e.jsx(c.Button,{value:"left",children:"居左"}),e.jsx(c.Button,{value:"right",children:"居右"})]})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{label:"表头跨列",name:"colSpan",children:e.jsx(S,{placeholder:"eg: 3"})})})]})]}),Z=()=>{const a={labelCol:{span:4},wrapperCol:{span:8}};return e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{label:"显示格式",name:"type",...a,children:e.jsxs(r,{children:[e.jsx(r.Option,{value:"text",children:"单行文本"}),e.jsx(r.Option,{value:"multiline",children:e.jsxs(g,{justify:"space-between",children:[e.jsx("span",{children:"多行文本"}),e.jsx("span",{children:e.jsx(v,{title:"需要返回数组格式：[{label: '名称',value: 'Jack'}]",children:e.jsx(I,{})})})]})}),e.jsx(r.Option,{value:"status",children:e.jsxs(g,{justify:"space-between",children:[e.jsx("span",{children:"状态"}),e.jsx("span",{children:e.jsx(v,{title:"需要返回数组格式：[{status: 'success',text: '提交完成'}]",children:e.jsx(I,{})})})]})}),e.jsx(r.Option,{value:"image",children:e.jsxs(g,{justify:"space-between",children:[e.jsx("span",{children:"图片"}),e.jsx("span",{children:e.jsx(v,{title:"支持单张和多张预览，多张图片格式：['xxx.png','xxx.jpg']",children:e.jsx(I,{})})})]})}),e.jsx(r.Option,{value:"date1",children:"日期-不含时分秒"}),e.jsx(r.Option,{value:"date2",children:"日期-包含时分秒"}),e.jsx(r.Option,{value:"money",children:"金额千分位"}),e.jsx(r.Option,{value:"number",children:"数字千分位"}),e.jsx(r.Option,{value:"tag",children:e.jsxs(g,{justify:"space-between",children:[e.jsx("span",{children:"标签"}),e.jsx("span",{children:e.jsx(v,{title:"支持颜色配置，返回格式：[{label:'名称',color:'green'}]",children:e.jsx(I,{})})})]})}),e.jsx(r.Option,{value:"action",children:"操作"})]})}),e.jsx(t.Item,{label:"可点击",name:"clickable",tooltip:"开启后，当前列展示为可点击的link格式，支持事件配置",...a,children:e.jsx(y,{})}),e.jsx(t.Item,{name:"eventName",hidden:!0,children:e.jsx(x,{})}),e.jsx(t.Item,{label:"超长省略",name:"ellipsis",tooltip:"省略后，会自动开启tooltip功能",...a,children:e.jsx(y,{})}),e.jsx(t.Item,{label:"可复制",name:"copyable",tooltip:"开启后，列增加复制功能，只对文本生效",...a,children:e.jsx(y,{})}),e.jsx(t.Item,{shouldUpdate:!0,noStyle:!0,children:p=>{if(p.getFieldValue("type")==="image")return e.jsxs(t.Item,{name:"imageConfig",children:[e.jsx(t.Item,{label:"宽度",name:["imageConfig","width"],...a,children:e.jsx(x,{placeholder:"string | number"})}),e.jsx(t.Item,{label:"高度",name:["imageConfig","height"],...a,children:e.jsx(x,{placeholder:"string | number"})})]})}}),e.jsx(t.Item,{shouldUpdate:!0,children:p=>p.getFieldValue("type")==="action"?e.jsx(t.Item,{label:"折叠按钮",name:"moreActionIndex",...a,tooltip:"指定从第n个按钮开始折叠",children:e.jsx(S,{min:0,max:999,style:{width:"60px"}})}):null}),e.jsx(t.Item,{shouldUpdate:!0,noStyle:!0,children:p=>{if(p.getFieldValue("type")==="action")return e.jsx(t.List,{name:"list",children:(h,{add:C,remove:k})=>e.jsxs(e.Fragment,{children:[h.map(({key:F,name:n,...i})=>e.jsx(Q,{style:{width:"100%",marginBottom:10},title:"操作按钮设置",size:"small",extra:e.jsx(V,{onClick:()=>k(n),icon:e.jsx(W,{}),type:"text",danger:!0,children:"删除"}),children:e.jsxs(b,{gutter:5,style:{marginBottom:-24},children:[e.jsx(s,{span:7,children:e.jsx(t.Item,{...i,name:[n,"text"],label:"名称",children:e.jsx(E,{})})}),e.jsx(s,{span:3,children:e.jsx(t.Item,{label:"danger",name:[n,"danger"],labelCol:{span:14},valuePropName:"checked",children:e.jsx(y,{})})}),e.jsx(s,{span:7,children:e.jsx(t.Item,{label:"权限标识",tooltip:"项目配置后台对应的按钮code",name:[n,"authCode"],labelCol:{span:8},children:e.jsx(x,{placeholder:"按钮Code"})})}),e.jsxs(s,{span:7,children:[e.jsx(t.Item,{label:"三方脚本",tooltip:"通过脚本实现第三方系统按钮权限",name:[n,"authScript"],labelCol:{span:8},children:e.jsx(E,{placeholder:"自定义权限，执行脚本"})}),e.jsx(t.Item,{name:[n,"eventName"],hidden:!0,children:e.jsx(x,{})})]})]})},F)),e.jsx("div",{style:{marginTop:15},children:e.jsx(V,{type:"dashed",block:!0,onClick:()=>C({text:"按钮",type:"link",eventName:M("Dynamic")}),icon:e.jsx(X,{}),children:"新增操作按钮"})})]})})}})]})},_=()=>e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx(s,{span:24,children:e.jsx(t.Item,{label:"单元格渲染",name:"onCell",labelCol:{span:4},wrapperCol:{span:21},tooltip:"通过自定义onCell函数，实现数据跨行、跨列展示。",children:e.jsx($,{})})})}),e.jsx(b,{children:e.jsx(s,{span:24,children:e.jsx(t.Item,{label:"自定义渲染",name:"render",labelCol:{span:4},wrapperCol:{span:21},tooltip:"通过编程的方式实现值渲染，不支持ReactNode渲染。例如：if(text === 1)return '在线'; ",children:e.jsx($,{})})})})]});export{qe as default};
