import{r as p,a as A,j as o,B as u,T as l}from"./index-CY1Ymj4r.js";import{handleApi as C}from"./handleApi-Bz3x1xZ4.js";import{i as w,f as h,a as m}from"./util-UBnOudtO.js";import{handleActionFlow as B}from"./action-BWjACvR_.js";import{D as N}from"./index-Sy3WWpq7.js";import{T as s}from"./index-ELXMiYH9.js";import{I as F}from"./index-BH8xWKmO.js";import{T as S}from"./index-BcUfWEv4.js";import"./request-K5LtYnQH.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./useComponentRefs-BjsmN1lJ.js";import"./row-C5ps4gU6.js";import"./useBreakpoint-D-Sgac-T.js";import"./useForceUpdate-BsEHW89a.js";import"./EditOutlined-JZ6BD8WC.js";import"./styleChecker-BBrBaNTm.js";import"./EnterOutlined-DS0cowoX.js";import"./TextArea-U5uDgpR6.js";import"./BaseInput-Bka7TPzR.js";import"./useVariants-B4R8rkTL.js";import"./index-C1u3Ql-g.js";import"./CopyOutlined-CQbFHu9s.js";import"./EyeOutlined-B6CobvGR.js";import"./addEventListener-e8APPF7k.js";import"./ZoomOutOutlined-t4Key8LE.js";const M=({id:j,type:b,config:a},T)=>{var y;const[g,c]=p.useState(!0),[t,d]=p.useState([]),z=A(e=>e.page.pageData.variableData);p.useEffect(()=>{k({})},[a.api,((y=a.api)==null?void 0:y.sourceType)=="variable"?z:""]);const k=e=>{C(a.api,e).then(r=>{(r==null?void 0:r.code)===0&&(Array.isArray(r.data)?d(r.data):d([r.data]))})};p.useImperativeHandle(T,()=>({show(){c(!0)},hide(){c(!1)}}));const f=(e,r)=>{const i=a.events.find(n=>n.eventName===e);B(i==null?void 0:i.actions,r)},D=(e,r,i)=>{if(w(e)?r.type==="money"?e=h(e,"currency"):r.type==="number"?e=h(e):r.type==="date1"?e=m(e,"YYYY-MM-DD"):r.type==="date2"&&(e=m(e)):typeof a.props.empty>"u"?e="-":a.props.empty&&(e=a.props.empty),r.render)try{e=new Function("text","record",`return (${r.render})(text,record);`)(e,i)}catch(n){console.error(`列[${r.title}]渲染失败`,n),e="解析异常"}if(r.type==="text"){const n=o.jsx(u,{type:"link",onClick:()=>f(r.eventName,i),children:e.toString()});return r.ellipsis&&r.copyable?o.jsx(l,{title:e,children:o.jsx(s.Paragraph,{copyable:!0,style:{marginBottom:0},children:r.clickable?n:e.toString()})}):r.ellipsis?o.jsx(l,{title:e,children:r.clickable?n:e.toString()}):r.copyable?o.jsx(s.Paragraph,{copyable:!0,children:r.clickable?n:e.toString()}):r.clickable?o.jsx(u,{type:"link",onClick:()=>f(r.eventName,i),children:e.toString()}):r.openTooltip?o.jsx(l,{title:r.tipContent,children:o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}):o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}return r.type==="image"?o.jsx(F,{src:e,width:30}):r.type==="tag"?Array.isArray(e)?e.map(n=>o.jsx(S,{children:n},n)):typeof e=="string"||typeof e=="number"?o.jsx(S,{children:e}):e==null?void 0:e.toString():r.openTooltip?o.jsx(l,{title:r.tipContent,children:o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}):o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})},v=p.useMemo(()=>a.props.items.map(e=>{var n;const r=((n=t[0])==null?void 0:n[e.name])||"",i=D(r,e,t[0]||{});return{key:e.key,label:e.label,children:i,span:e.span}}),[a.props.items,t]);return g&&o.jsx(N,{...a.props,items:v,"data-id":j,"data-type":b,style:a.style})},ie=p.forwardRef(M);export{ie as default};
