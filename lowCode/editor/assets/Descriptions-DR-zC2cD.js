import{r as p,a as A,j as o,B as u,T as l}from"./index-DmOc0qNU.js";import{handleApi as C}from"./handleApi-CJLwph67.js";import{i as w,f as h,a as m}from"./util-DNkFm-j2.js";import{handleActionFlow as B}from"./action-CbrbshM_.js";import{D as N}from"./index-DIJm4IIM.js";import{T as s}from"./index-BytaExX6.js";import{I as F}from"./index-jIBCjwxt.js";import{T as S}from"./index-DFI99UhQ.js";import"./request-C0MTnMVW.js";import"./index-C0E5Fhz-.js";import"./_baseGet-xRkAGEE7.js";import"./useComponentRefs-BjsmN1lJ.js";import"./row-pIc0FM19.js";import"./useBreakpoint-Dj2PHoq7.js";import"./useForceUpdate-Y5LXbfsE.js";import"./EditOutlined-D6nYSc60.js";import"./styleChecker-CQ-R2cXJ.js";import"./EnterOutlined-D0ebLqDC.js";import"./TextArea-D7VuO_-I.js";import"./BaseInput-4F0kfgVN.js";import"./useVariants-BdxfBOl3.js";import"./index-DOHCQObp.js";import"./CopyOutlined-BRIAy90h.js";import"./EyeOutlined-QFSiY36E.js";import"./addEventListener-CKCD8Vpz.js";import"./ZoomOutOutlined-IpS0JADO.js";const M=({id:j,type:b,config:a},T)=>{var y;const[g,c]=p.useState(!0),[t,d]=p.useState([]),z=A(e=>e.page.pageData.variableData);p.useEffect(()=>{k({})},[a.api,((y=a.api)==null?void 0:y.sourceType)=="variable"?z:""]);const k=e=>{C(a.api,e).then(r=>{(r==null?void 0:r.code)===0&&(Array.isArray(r.data)?d(r.data):d([r.data]))})};p.useImperativeHandle(T,()=>({show(){c(!0)},hide(){c(!1)}}));const f=(e,r)=>{const i=a.events.find(n=>n.eventName===e);B(i==null?void 0:i.actions,r)},D=(e,r,i)=>{if(w(e)?r.type==="money"?e=h(e,"currency"):r.type==="number"?e=h(e):r.type==="date1"?e=m(e,"YYYY-MM-DD"):r.type==="date2"&&(e=m(e)):typeof a.props.empty>"u"?e="-":a.props.empty&&(e=a.props.empty),r.render)try{e=new Function("text","record",`return (${r.render})(text,record);`)(e,i)}catch(n){console.error(`列[${r.title}]渲染失败`,n),e="解析异常"}if(r.type==="text"){const n=o.jsx(u,{type:"link",onClick:()=>f(r.eventName,i),children:e.toString()});return r.ellipsis&&r.copyable?o.jsx(l,{title:e,children:o.jsx(s.Paragraph,{copyable:!0,style:{marginBottom:0},children:r.clickable?n:e.toString()})}):r.ellipsis?o.jsx(l,{title:e,children:r.clickable?n:e.toString()}):r.copyable?o.jsx(s.Paragraph,{copyable:!0,children:r.clickable?n:e.toString()}):r.clickable?o.jsx(u,{type:"link",onClick:()=>f(r.eventName,i),children:e.toString()}):r.openTooltip?o.jsx(l,{title:r.tipContent,children:o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}):o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}return r.type==="image"?o.jsx(F,{src:e,width:30}):r.type==="tag"?Array.isArray(e)?e.map(n=>o.jsx(S,{children:n},n)):typeof e=="string"||typeof e=="number"?o.jsx(S,{children:e}):e==null?void 0:e.toString():r.openTooltip?o.jsx(l,{title:r.tipContent,children:o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})}):o.jsx(s.Text,{style:{fontSize:r.fontSize?r.fontSize:14},children:e==null?void 0:e.toString()})},v=p.useMemo(()=>a.props.items.map(e=>{var n;const r=((n=t[0])==null?void 0:n[e.name])||"",i=D(r,e,t[0]||{});return{key:e.key,label:e.label,children:i,span:e.span}}),[a.props.items,t]);return g&&o.jsx(N,{...a.props,items:v,"data-id":j,"data-type":b,style:a.style})},ie=p.forwardRef(M);export{ie as default};
