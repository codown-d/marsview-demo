import{r as e,a as M,f as N,j as s}from"./index-DmOc0qNU.js";import{c as P}from"./shallow-DkvW6rgF.js";import{g as R}from"./index-D_sh-7v0.js";import{M as H}from"./MarsRender-CU_k9oCt.js";import{FormContext as S}from"./context-CwFBKCg9.js";import{d as c,i as T,b as k,e as B}from"./util-DNkFm-j2.js";import{F as y}from"./index-1_6nT-oA.js";import{u as O}from"./useDrop-BKAPRNi5.js";import"./SoundOutlined-C2LYByLL.js";import"./DownOutlined-DnWdyoG8.js";import"./UpOutlined-CkYvBYD1.js";import"./action-CbrbshM_.js";import"./useComponentRefs-BjsmN1lJ.js";import"./handleApi-CJLwph67.js";import"./request-C0MTnMVW.js";import"./index-C0E5Fhz-.js";import"./_baseGet-xRkAGEE7.js";import"./index-CcJLco_Z.js";import"./scrollTo-D0zr6O2z.js";import"./index-DSaINUG7.js";import"./useShowArrow-CIjY5B73.js";import"./List-BV6fBbjc.js";import"./index-wVmnK_0F.js";import"./useIcons-CLAJNkrF.js";import"./SearchOutlined-DscCkqW9.js";import"./useVariants-BdxfBOl3.js";import"./index-Df3uJrKd.js";import"./row-pIc0FM19.js";import"./useBreakpoint-Dj2PHoq7.js";import"./useForceUpdate-Y5LXbfsE.js";import"./index-BIB-vVSn.js";import"./SwapRightOutlined-l_ApuJtI.js";import"./index-DOHCQObp.js";import"./index-DxJl0Bxc.js";import"./index-B5-G8EA2.js";import"./index-PKq6ibgt.js";import"./index-Dg1x3Ybx.js";import"./PlusOutlined-BSTEPWl7.js";import"./index-DfZhUM4Q.js";import"./conductUtil-wNhCxpcs.js";import"./index-B2mTmS5H.js";import"./index-Bp74baIv.js";import"./ColorPicker-CHwPjknD.js";import"./index-Do4qj9dd.js";import"./index-eEpHjpWF.js";import"./index-o7l-rjNw.js";import"./BaseInput-4F0kfgVN.js";import"./index-B-YUPJxN.js";import"./TextArea-D7VuO_-I.js";import"./EyeInvisibleOutlined-Cl_PTdo5.js";import"./EyeOutlined-QFSiY36E.js";import"./index-C-pH6dK5.js";import"./index-DIJm4IIM.js";import"./index-jIBCjwxt.js";import"./addEventListener-CKCD8Vpz.js";import"./ZoomOutOutlined-IpS0JADO.js";import"./index-CW6BFuNZ.js";import"./extendsObject-keMuGWqj.js";import"./Pagination-B_kLQQfV.js";import"./DoubleRightOutlined-FRvrxn3q.js";import"./index-BytaExX6.js";import"./EditOutlined-D6nYSc60.js";import"./styleChecker-CQ-R2cXJ.js";import"./EnterOutlined-D0ebLqDC.js";import"./CopyOutlined-BRIAy90h.js";import"./index-_pMv_sKm.js";import"./index-CAhQjzfH.js";import"./index-B6d_3ZHh.js";import"./PlusSquareOutlined-D0i2U-a9.js";import"./FolderOpenOutlined-Bj6jPccg.js";import"./HolderOutlined-CzOeoeCY.js";import"./index-C3QLbPSd.js";import"./AlignRightOutlined-Kg291cY_.js";import"./UsergroupAddOutlined-Bx2neJ9_.js";import"./RedoOutlined-C4rr1ZME.js";import"./CaretDownOutlined-Cvfi80LL.js";import"./FilterFilled-BYB9ZItm.js";import"./ExclamationCircleOutlined-DHCAK7Yp.js";import"./DeleteOutlined-BnUSKaGo.js";import"./MoreOutlined-C8o90ux3.js";import"./FunctionOutlined-Dm0pzJNb.js";import"./InfoCircleOutlined-D9lj3ic_.js";import"./TeamOutlined-B9XPKo8Z.js";import"./NotificationOutlined-DlRBMYlM.js";import"./MinusOutlined-Cj88Lgeh.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./SaveOutlined-Da_V74JD.js";import"./SettingOutlined-CGW_ik-t.js";import"./SyncOutlined-D_H3wSeZ.js";import"./WarningFilled-DrN-C8wT.js";import"./LockOutlined-COu0XHB3.js";import"./UserOutlined-DAUrDjKa.js";import"./index-DBzmE0wc.js";import"./index-zUAcsxVR.js";import"./index-9ch0MKpQ.js";import"./index-DFI99UhQ.js";import"./index-KkE6TN4K.js";import"./Table-ChTYBmDg.js";import"./createLoading-4QOu0SEw.js";import"./debounce-CoSCf5Zb.js";import"./index-Dbrwdd6Z.js";import"./index-BUKMMZAh.js";import"./index-BmnSvrnD.js";import"./index-DYQX7UPG.js";/* empty css              */import"./omit-K9EDc_4o.js";import"./useDragDropManager-Dl0-aEZk.js";const _=({id:m,type:F,config:u,elements:a,onFinish:n,onChange:d},v)=>{const[p]=y.useForm(),{addChildElements:h,formData:f,setFormData:l}=M(P(t=>({addChildElements:t.addChildElements,formData:t.page.pageData.formData,setFormData:t.setFormData}))),[x,D]=e.useState(!0),[V,b]=e.useState({}),[,j]=O({accept:"MENU_ITEM",async drop(t,r){var g;if(r.didDrop())return;const{config:o,events:i,methods:I=[]}=((g=await R(t.type+"Config"))==null?void 0:g.default)||{};h({type:t.type,name:t.name,parentId:m,id:t.id,config:o,events:i,methods:I})},collect:t=>({isOver:t.isOver(),canDrop:t.canDrop()})}),E=t=>{n==null||n(c(a,t))},w=(t,r)=>{const o=c(a,r);d==null||d(o),l({name:m,value:o})};e.useImperativeHandle(v,()=>({show(){D(!0)},hide(){D(!1)},reset(){p.resetFields(),l({name:m,value:p.getFieldsValue(),type:"override"})},submit(){p.submit()},async validate(){try{return await p.validateFields(),!0}catch(t){return console.error(t),!1}},init(t={}){const r=c(a,t);p.setFieldsValue({...r}),l({name:m,value:{...r},type:"override"})},getFormData(t){var r;return t&&typeof t=="string"?(r=f[m])==null?void 0:r[t]:f[m]}}));const C=e.useCallback((t,r,o)=>{if(r&&T(o)){let i=o;t==="InputNumber"&&(i=Number(o)),t==="DatePicker"&&(i=k(o)),t==="DatePickerRange"&&(i=B(o)),t==="TimePicker"&&(i=N(o,"HH:mm:ss")),b({[r]:i}),p.setFieldValue([r],i),l({name:m,value:{[r]:i}})}},[]);return x&&s.jsx(S.Provider,{value:{form:p,initValues:C},children:s.jsx("div",{ref:j,children:s.jsx(y,{form:p,style:u.style,...u.props,"data-id":m,"data-type":F,initialValues:V,onFinish:E,onValuesChange:w,children:a.length?s.jsx(H,{elements:a}):s.jsx("div",{className:"slots",style:{lineHeight:"150px"},children:"拖拽表单组件到这里"})})})})},_r=e.memo(e.forwardRef(_));export{_r as default};
