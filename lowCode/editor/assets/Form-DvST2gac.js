import{r as e,a as M,f as N,j as s}from"./index-CY1Ymj4r.js";import{c as P}from"./shallow-Bi0WipZC.js";import{g as R}from"./index-Bkuj5IWs.js";import{M as H}from"./MarsRender-B9LyhaO3.js";import{FormContext as S}from"./context-lPMLs1NY.js";import{d as c,i as T,b as k,e as B}from"./util-UBnOudtO.js";import{F as y}from"./index-BKDg-K48.js";import{u as O}from"./useDrop-D9SfugPi.js";import"./SoundOutlined-B7v31N9V.js";import"./DownOutlined-QYs-kCMH.js";import"./UpOutlined-Bu3BOxje.js";import"./action-BWjACvR_.js";import"./useComponentRefs-BjsmN1lJ.js";import"./handleApi-Bz3x1xZ4.js";import"./request-K5LtYnQH.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./index-B0UeyOoa.js";import"./scrollTo-hj5AlJ0c.js";import"./index-CUKOry-Y.js";import"./useShowArrow-C9phI0pM.js";import"./List-CfIaGhIa.js";import"./index-DYezmHfp.js";import"./useIcons-CYuILU2n.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./useVariants-B4R8rkTL.js";import"./index-BC5zvAmk.js";import"./row-C5ps4gU6.js";import"./useBreakpoint-D-Sgac-T.js";import"./useForceUpdate-BsEHW89a.js";import"./index-DOjNdDXR.js";import"./SwapRightOutlined-CcIdOt_e.js";import"./index-C1u3Ql-g.js";import"./index-CrCWvzoA.js";import"./index-CVwKh-ii.js";import"./index-DBtJBM7q.js";import"./index-Tz3gITLY.js";import"./PlusOutlined-dRNvmZ2Y.js";import"./index-CksWDIx9.js";import"./conductUtil-oPofkrzY.js";import"./index-CMyR3-Rp.js";import"./index-B5fUo_Hm.js";import"./ColorPicker-CHT1xIcH.js";import"./index-CQwwCPyp.js";import"./index-jYDJ93V_.js";import"./index-BnlvMKaU.js";import"./BaseInput-Bka7TPzR.js";import"./index-Du8QL6nv.js";import"./TextArea-U5uDgpR6.js";import"./EyeInvisibleOutlined-DDX5Jvzv.js";import"./EyeOutlined-B6CobvGR.js";import"./index-DQZxJH5O.js";import"./index-Sy3WWpq7.js";import"./index-BH8xWKmO.js";import"./addEventListener-e8APPF7k.js";import"./ZoomOutOutlined-t4Key8LE.js";import"./index-BX8mFvI3.js";import"./extendsObject-keMuGWqj.js";import"./Pagination-BhehRHa0.js";import"./DoubleRightOutlined-BcWxf5hS.js";import"./index-ELXMiYH9.js";import"./EditOutlined-JZ6BD8WC.js";import"./styleChecker-BBrBaNTm.js";import"./EnterOutlined-DS0cowoX.js";import"./CopyOutlined-CQbFHu9s.js";import"./index-ClLmsWSS.js";import"./index-CYqyuSLi.js";import"./index-BqJLt5d9.js";import"./PlusSquareOutlined-D3cnUxWk.js";import"./FolderOpenOutlined-CDyAvlLT.js";import"./HolderOutlined-E1hrqN51.js";import"./index-C4qQ40vK.js";import"./AlignRightOutlined-BaOygGam.js";import"./UsergroupAddOutlined-DQ7Kwpsy.js";import"./RedoOutlined-CJagRpK4.js";import"./CaretDownOutlined-fvgXmNbc.js";import"./FilterFilled-S1ql0Sss.js";import"./ExclamationCircleOutlined-CkY-Dzll.js";import"./DeleteOutlined-BfdCKHnO.js";import"./MoreOutlined-BHx2P-s-.js";import"./FunctionOutlined-D3UO96Yh.js";import"./InfoCircleOutlined-DWZ7nUzE.js";import"./TeamOutlined-BmFXVwN3.js";import"./NotificationOutlined-C3CDmrw2.js";import"./MinusOutlined-CsSa3QgW.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./SaveOutlined-CRp1-oFH.js";import"./SettingOutlined-B7WTL30f.js";import"./SyncOutlined-SA527A4F.js";import"./WarningFilled-k-vsk_P7.js";import"./LockOutlined-Bzfo-a2y.js";import"./UserOutlined-CjZcwOl4.js";import"./index-A8dvgHKY.js";import"./index-BqOjOWET.js";import"./index-DSFQlR52.js";import"./index-BcUfWEv4.js";import"./index-Cvc_fY4H.js";import"./Table-DKwxKTfy.js";import"./createLoading-DlTFYMve.js";import"./debounce-HTNO8IKQ.js";import"./index-BE3-2UW5.js";import"./index-BrX3WsUn.js";import"./index-DCDTgQ2T.js";import"./index-BP2XVsbv.js";/* empty css              */import"./omit-BC7ibGNK.js";import"./useDragDropManager-DvbAW2Fo.js";const _=({id:m,type:F,config:u,elements:a,onFinish:n,onChange:d},v)=>{const[p]=y.useForm(),{addChildElements:h,formData:f,setFormData:l}=M(P(t=>({addChildElements:t.addChildElements,formData:t.page.pageData.formData,setFormData:t.setFormData}))),[x,D]=e.useState(!0),[V,b]=e.useState({}),[,j]=O({accept:"MENU_ITEM",async drop(t,r){var g;if(r.didDrop())return;const{config:o,events:i,methods:I=[]}=((g=await R(t.type+"Config"))==null?void 0:g.default)||{};h({type:t.type,name:t.name,parentId:m,id:t.id,config:o,events:i,methods:I})},collect:t=>({isOver:t.isOver(),canDrop:t.canDrop()})}),E=t=>{n==null||n(c(a,t))},w=(t,r)=>{const o=c(a,r);d==null||d(o),l({name:m,value:o})};e.useImperativeHandle(v,()=>({show(){D(!0)},hide(){D(!1)},reset(){p.resetFields(),l({name:m,value:p.getFieldsValue(),type:"override"})},submit(){p.submit()},async validate(){try{return await p.validateFields(),!0}catch(t){return console.error(t),!1}},init(t={}){const r=c(a,t);p.setFieldsValue({...r}),l({name:m,value:{...r},type:"override"})},getFormData(t){var r;return t&&typeof t=="string"?(r=f[m])==null?void 0:r[t]:f[m]}}));const C=e.useCallback((t,r,o)=>{if(r&&T(o)){let i=o;t==="InputNumber"&&(i=Number(o)),t==="DatePicker"&&(i=k(o)),t==="DatePickerRange"&&(i=B(o)),t==="TimePicker"&&(i=N(o,"HH:mm:ss")),b({[r]:i}),p.setFieldValue([r],i),l({name:m,value:{[r]:i}})}},[]);return x&&s.jsx(S.Provider,{value:{form:p,initValues:C},children:s.jsx("div",{ref:j,children:s.jsx(y,{form:p,style:u.style,...u.props,"data-id":m,"data-type":F,initialValues:V,onFinish:E,onValuesChange:w,children:a.length?s.jsx(H,{elements:a}):s.jsx("div",{className:"slots",style:{lineHeight:"150px"},children:"拖拽表单组件到这里"})})})})},_r=e.memo(e.forwardRef(_));export{_r as default};
