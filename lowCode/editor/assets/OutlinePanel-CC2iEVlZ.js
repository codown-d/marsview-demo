import{r as a,a as D,j as u,dl as T,K as f}from"./index-CY1Ymj4r.js";import{c as k}from"./shallow-Bi0WipZC.js";import{s as K}from"./index-CGFTxKND.js";import{R as b}from"./row-C5ps4gU6.js";import{T as v}from"./index-BqJLt5d9.js";import{R as A}from"./DownOutlined-QYs-kCMH.js";import"./SoundOutlined-B7v31N9V.js";import"./UpOutlined-Bu3BOxje.js";import"./index-DGBlI9oV.js";import"./debounce-HTNO8IKQ.js";import"./index-Bkuj5IWs.js";import"./useDrag-Bq04PC8Y.js";import"./useDragDropManager-DvbAW2Fo.js";import"./index-DYezmHfp.js";import"./index-Tz3gITLY.js";import"./PlusOutlined-dRNvmZ2Y.js";import"./index-Du8QL6nv.js";import"./index-C1u3Ql-g.js";import"./BaseInput-Bka7TPzR.js";import"./TextArea-U5uDgpR6.js";import"./useVariants-B4R8rkTL.js";import"./EyeInvisibleOutlined-DDX5Jvzv.js";import"./EyeOutlined-B6CobvGR.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./index-CQwwCPyp.js";import"./UsergroupAddOutlined-DQ7Kwpsy.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./FunctionOutlined-D3UO96Yh.js";import"./List-CfIaGhIa.js";import"./conductUtil-oPofkrzY.js";import"./PlusSquareOutlined-D3cnUxWk.js";import"./FolderOpenOutlined-CDyAvlLT.js";import"./HolderOutlined-E1hrqN51.js";import"./index-CMyR3-Rp.js";const ue=a.memo(()=>{const{pageName:E,elements:d,selectedEl:c,setSelectedElement:g,dragSortElements:h}=D(k(e=>({pageName:e.page.name,elements:e.page.pageData.elements,selectedEl:e.selectedElement,setSelectedElement:e.setSelectedElement,dragSortElements:e.dragSortElements}))),[S,p]=a.useState([]),x=a.useMemo(()=>[{type:`页面【${E}】`,id:"page",elements:d}],[d]);a.useEffect(()=>{p(c?[c.id]:[])},[c]);const I=(e,{node:r})=>{p(e),e.length>0?e[0]==="page"?g(void 0):g({id:r.id,type:r.type}):g(void 0)},N=e=>{const{key:r,type:P,name:j,elements:w}=e.dragNode,{key:s}=e.node,y=e.node.pos.split("-"),R=e.dropPosition-Number(y[y.length-1]),i=T(d),l=f(i,r);l&&l.elements&&l.elements.splice(l.index,1);const n={id:r,type:P,name:j,elements:w};let m=null;if(e.dropToGap){const{index:t,elements:o}=f(i,s)||{item:{},index:0};m=o[t].parentId,R===-1?o==null||o.splice(t,0,{...n,parentId:m}):o==null||o.splice(t+1,0,{...n,parentId:m})}else if(s=="page")i.unshift(n);else{const{element:t}=f(i,s);t&&(m=s,t.elements=t.elements||[],t.elements.unshift({...n,parentId:s}))}h({id:r,list:i,parentId:m}),p([])};return u.jsx(b,{className:K.outlinePanel,children:u.jsx(v,{showLine:!0,defaultExpandAll:!0,draggable:!0,switcherIcon:u.jsx(A,{}),fieldNames:{title:"type",key:"id",children:"elements"},treeData:x,selectedKeys:S,onSelect:I,onDrop:N,style:{width:"100%"}})})});export{ue as default};
