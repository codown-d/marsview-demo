import{r as a,a as D,j as u,dl as T,K as f}from"./index-DmOc0qNU.js";import{c as k}from"./shallow-DkvW6rgF.js";import{s as K}from"./index-CLR_EJjz.js";import{R as b}from"./row-pIc0FM19.js";import{T as v}from"./index-B6d_3ZHh.js";import{R as A}from"./DownOutlined-DnWdyoG8.js";import"./SoundOutlined-C2LYByLL.js";import"./UpOutlined-CkYvBYD1.js";import"./index-CrdplzP2.js";import"./debounce-CoSCf5Zb.js";import"./index-D_sh-7v0.js";import"./useDrag-1pt3QfON.js";import"./useDragDropManager-Dl0-aEZk.js";import"./index-wVmnK_0F.js";import"./index-Dg1x3Ybx.js";import"./PlusOutlined-BSTEPWl7.js";import"./index-B-YUPJxN.js";import"./index-DOHCQObp.js";import"./BaseInput-4F0kfgVN.js";import"./TextArea-D7VuO_-I.js";import"./useVariants-BdxfBOl3.js";import"./EyeInvisibleOutlined-Cl_PTdo5.js";import"./EyeOutlined-QFSiY36E.js";import"./SearchOutlined-DscCkqW9.js";import"./index-Do4qj9dd.js";import"./UsergroupAddOutlined-Bx2neJ9_.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./FunctionOutlined-Dm0pzJNb.js";import"./List-BV6fBbjc.js";import"./conductUtil-wNhCxpcs.js";import"./PlusSquareOutlined-D0i2U-a9.js";import"./FolderOpenOutlined-Bj6jPccg.js";import"./HolderOutlined-CzOeoeCY.js";import"./index-B2mTmS5H.js";const ue=a.memo(()=>{const{pageName:E,elements:d,selectedEl:c,setSelectedElement:g,dragSortElements:h}=D(k(e=>({pageName:e.page.name,elements:e.page.pageData.elements,selectedEl:e.selectedElement,setSelectedElement:e.setSelectedElement,dragSortElements:e.dragSortElements}))),[S,p]=a.useState([]),x=a.useMemo(()=>[{type:`页面【${E}】`,id:"page",elements:d}],[d]);a.useEffect(()=>{p(c?[c.id]:[])},[c]);const I=(e,{node:r})=>{p(e),e.length>0?e[0]==="page"?g(void 0):g({id:r.id,type:r.type}):g(void 0)},N=e=>{const{key:r,type:P,name:j,elements:w}=e.dragNode,{key:s}=e.node,y=e.node.pos.split("-"),R=e.dropPosition-Number(y[y.length-1]),i=T(d),l=f(i,r);l&&l.elements&&l.elements.splice(l.index,1);const n={id:r,type:P,name:j,elements:w};let m=null;if(e.dropToGap){const{index:t,elements:o}=f(i,s)||{item:{},index:0};m=o[t].parentId,R===-1?o==null||o.splice(t,0,{...n,parentId:m}):o==null||o.splice(t+1,0,{...n,parentId:m})}else if(s=="page")i.unshift(n);else{const{element:t}=f(i,s);t&&(m=s,t.elements=t.elements||[],t.elements.unshift({...n,parentId:s}))}h({id:r,list:i,parentId:m}),p([])};return u.jsx(b,{className:K.outlinePanel,children:u.jsx(v,{showLine:!0,defaultExpandAll:!0,draggable:!0,switcherIcon:u.jsx(A,{}),fieldNames:{title:"type",key:"id",children:"elements"},treeData:x,selectedKeys:S,onSelect:I,onDrop:N,style:{width:"100%"}})})});export{ue as default};
