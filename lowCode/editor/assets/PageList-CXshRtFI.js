import{r as s,a as P,u as M,d as j,j as t,ah as T,B as c,S as b,M as F,dV as $,m as w}from"./index-CY1Ymj4r.js";import{C as z}from"./CreatePage-rJS2TlmG.js";import{R as D}from"./PlusOutlined-dRNvmZ2Y.js";import{R as N}from"./SyncOutlined-SA527A4F.js";import{L as p}from"./index-BX8mFvI3.js";import{T as A}from"./index-BcUfWEv4.js";import{R as B}from"./DeleteOutlined-BfdCKHnO.js";import{R as E}from"./EditOutlined-JZ6BD8WC.js";import"./project-RurpUGJo.js";import"./TextArea-U5uDgpR6.js";import"./BaseInput-Bka7TPzR.js";import"./useVariants-B4R8rkTL.js";import"./index-C1u3Ql-g.js";import"./index-BKDg-K48.js";import"./row-C5ps4gU6.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./index-ClLmsWSS.js";import"./index-Du8QL6nv.js";import"./EyeInvisibleOutlined-DDX5Jvzv.js";import"./EyeOutlined-B6CobvGR.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./index-CUKOry-Y.js";import"./useShowArrow-C9phI0pM.js";import"./List-CfIaGhIa.js";import"./index-DYezmHfp.js";import"./useIcons-CYuILU2n.js";import"./DownOutlined-QYs-kCMH.js";import"./extendsObject-keMuGWqj.js";import"./useBreakpoint-D-Sgac-T.js";import"./useForceUpdate-BsEHW89a.js";import"./Pagination-BhehRHa0.js";import"./DoubleRightOutlined-BcWxf5hS.js";const ye=s.memo(()=>{const a=s.useRef(),[h,n]=s.useState(!0),[r,l]=s.useState([]),{pageId:y,projectId:S}=P(e=>({pageId:e.page.id,projectId:e.page.projectId})),[m,I]=s.useState(1),[d,O]=s.useState(16),[L,k]=s.useState(!0),[R,g]=s.useState(!1),f=M();s.useEffect(()=>{n(!0),i(1)},[]);const i=async e=>{e>1?g(!0):n(!0);const o=await j.getPageList({pageNum:e||m,pageSize:d,projectId:S});I(e),n(!1),g(!1),o.list.length<d&&k(!1),l(e===1?o.list:[...r,...o.list])},x=e=>{var o,u;e?(o=a.current)==null||o.open("edit",e):(u=a.current)==null||u.open("create")},v=async e=>{F.confirm({title:"确认",content:"删除后，将无法恢复，请谨慎操作？",okText:"确认",cancelText:"取消",onOk:async()=>{await j.delPageData({id:e}),$("pageList",e+""),w.success("删除成功"),i(1),r.length>0&&f(`/editor/${r[0].id}/edit`)}})},C=async(e,o)=>{e.preventDefault(),f(`/editor/${o}/edit`)};return t.jsxs(t.Fragment,{children:[t.jsxs(T,{justify:"space-between",align:"center",style:{borderBottom:"1px solid var(--mars-theme-card-border-color)"},children:[t.jsx(c,{type:"link",icon:t.jsx(D,{}),onClick:()=>x(),style:{marginLeft:-15},children:"新增"}),t.jsx(c,{type:"link",icon:t.jsx(N,{}),onClick:()=>{i(1)},children:"刷新"})]}),t.jsx(b,{spinning:h,children:t.jsxs("div",{style:{height:"calc(100vh - 150px)",overflowY:"auto"},children:[t.jsx(p,{itemLayout:"horizontal",dataSource:r,renderItem:e=>t.jsx(p.Item,{actions:[e.id===y?t.jsx(A,{color:"#7D33FF",children:"当前"}):"",t.jsx(B,{onClick:()=>v(e.id)}),t.jsx(E,{onClick:()=>x(e)})],children:t.jsx(p.Item.Meta,{title:t.jsx("a",{onClick:o=>C(o,e.id),children:e.name})})})}),L?t.jsx("div",{style:{textAlign:"center",padding:10},children:t.jsx(c,{block:!0,loading:R,onClick:()=>{i(m+1)},children:"加载更多"})}):t.jsx("div",{style:{fontSize:"12px",borderTop:"1px solid #f5f5f5",marginTop:"12px",padding:"5px",textAlign:"center"},children:"没有更多了"})]})}),t.jsx(z,{createRef:a,update:()=>{console.log(12352),i(1)}})]})});export{ye as default};
