import{r,a as S,j as v}from"./index-CY1Ymj4r.js";import{handleApi as V}from"./handleApi-Bz3x1xZ4.js";import{i as y}from"./util-UBnOudtO.js";import{useFormContext as W}from"./context-lPMLs1NY.js";import{F as A}from"./index-BKDg-K48.js";import{R as F}from"./index-CrCWvzoA.js";import"./request-K5LtYnQH.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./row-C5ps4gU6.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./index-CVwKh-ii.js";const w=({id:x,type:d,config:a,onChange:o},D)=>{var f;const[E,i]=r.useState([]),[R,m]=r.useState(!0),[c,l]=r.useState(),{initValues:I}=W(),h=S(e=>e.page.pageData.variableData);r.useEffect(()=>{var s;const e=(s=a.props.formItem)==null?void 0:s.name,t=a.props.defaultValue;I(d,e,t)},[a.props.defaultValue]),r.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&l(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),r.useEffect(()=>{u({})},[a.api,((f=a.api)==null?void 0:f.sourceType)=="variable"?h:""]);const u=e=>{V(a.api,e).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[radio]","data数据格式错误，请检查"),i([]);else{let s=[];a.props.field.label==="label"&&a.props.field.value==="value"?(s=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(s=t.data.map(p=>({label:p,value:p})))):s=t.data.map(p=>{const b=p[a.props.field.label||"label"],n=p[a.props.field.value||"value"];return{label:y(b)?b:"-",value:y(n)?n:""}}),i(s)}})};r.useImperativeHandle(D,()=>({show(){m(!0)},hide(){m(!1)},enable(){l(!1)},disable(){l(!0)},update:e=>{u(e)}}));const j=e=>{o==null||o({[a.props.formItem.name]:e})};return R&&v.jsx(A.Item,{...a.props.formItem,"data-id":x,"data-type":d,children:v.jsx(F.Group,{...a.props.formWrap,disabled:c,options:E,style:a.style,onChange:e=>j(e.target.value)})})},J=r.forwardRef(w);export{J as default};
