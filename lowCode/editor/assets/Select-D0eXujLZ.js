import{r,a as j,j as v}from"./index-DmOc0qNU.js";import{handleApi as V}from"./handleApi-CJLwph67.js";import{i as y}from"./util-DNkFm-j2.js";import{useFormContext as A}from"./context-CwFBKCg9.js";import{F}from"./index-1_6nT-oA.js";import{S as w}from"./index-DSaINUG7.js";import"./request-C0MTnMVW.js";import"./index-C0E5Fhz-.js";import"./_baseGet-xRkAGEE7.js";import"./row-pIc0FM19.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./useShowArrow-CIjY5B73.js";import"./List-BV6fBbjc.js";import"./index-wVmnK_0F.js";import"./useIcons-CLAJNkrF.js";import"./DownOutlined-DnWdyoG8.js";import"./SearchOutlined-DscCkqW9.js";import"./useVariants-BdxfBOl3.js";const C=({id:c,type:l,config:a,onChange:m},S)=>{var f;const{initValues:h}=A(),[x,i]=r.useState([]),[D,d]=r.useState(!0),[E,s]=r.useState(),I=j(e=>e.page.pageData.variableData);r.useEffect(()=>{var p;const e=(p=a.props.formItem)==null?void 0:p.name,t=a.props.defaultValue;h(l,e,t)},[a.props.defaultValue]),r.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&s(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),r.useEffect(()=>{u({})},[a.api,((f=a.api)==null?void 0:f.sourceType)=="variable"?I:""]);const u=e=>{V(a.api,e).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[select]","data数据格式错误，请检查"),i([]);else{let p=[];a.props.field.label==="label"&&a.props.field.value==="value"?(p=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(p=t.data.map(o=>({label:o,value:o})))):p=t.data.map(o=>{const b=o[a.props.field.label||"label"],n=o[a.props.field.value||"value"];return{label:y(b)?b:"-",value:y(n)?n:""}}),i(p)}})};r.useImperativeHandle(S,()=>({show(){d(!0)},hide(){d(!1)},enable(){s(!1)},disable(){s(!0)},update:e=>{u(e)}}));const W=e=>{m&&m({[a.props.formItem.name]:e})};return D&&v.jsx(F.Item,{...a.props.formItem,"data-id":c,"data-type":l,children:v.jsx(w,{...a.props.formWrap,disabled:E,variant:a.props.formWrap.variant||void 0,options:x,style:a.style,onChange:e=>W(e)})})},X=r.forwardRef(C);export{X as default};
