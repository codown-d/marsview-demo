import{r,a as j,j as v}from"./index-CY1Ymj4r.js";import{handleApi as V}from"./handleApi-Bz3x1xZ4.js";import{i as y}from"./util-UBnOudtO.js";import{useFormContext as A}from"./context-lPMLs1NY.js";import{F}from"./index-BKDg-K48.js";import{S as w}from"./index-CUKOry-Y.js";import"./request-K5LtYnQH.js";import"./index-yDMkoRSw.js";import"./_baseGet-C1wBFXxd.js";import"./row-C5ps4gU6.js";import"./QuestionCircleOutlined-TTJW15q1.js";import"./useShowArrow-C9phI0pM.js";import"./List-CfIaGhIa.js";import"./index-DYezmHfp.js";import"./useIcons-CYuILU2n.js";import"./DownOutlined-QYs-kCMH.js";import"./SearchOutlined-DZ2l1XJ5.js";import"./useVariants-B4R8rkTL.js";const C=({id:c,type:l,config:a,onChange:m},S)=>{var f;const{initValues:h}=A(),[x,i]=r.useState([]),[D,d]=r.useState(!0),[E,s]=r.useState(),I=j(e=>e.page.pageData.variableData);r.useEffect(()=>{var p;const e=(p=a.props.formItem)==null?void 0:p.name,t=a.props.defaultValue;h(l,e,t)},[a.props.defaultValue]),r.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&s(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),r.useEffect(()=>{u({})},[a.api,((f=a.api)==null?void 0:f.sourceType)=="variable"?I:""]);const u=e=>{V(a.api,e).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[select]","data数据格式错误，请检查"),i([]);else{let p=[];a.props.field.label==="label"&&a.props.field.value==="value"?(p=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(p=t.data.map(o=>({label:o,value:o})))):p=t.data.map(o=>{const b=o[a.props.field.label||"label"],n=o[a.props.field.value||"value"];return{label:y(b)?b:"-",value:y(n)?n:""}}),i(p)}})};r.useImperativeHandle(S,()=>({show(){d(!0)},hide(){d(!1)},enable(){s(!1)},disable(){s(!0)},update:e=>{u(e)}}));const W=e=>{m&&m({[a.props.formItem.name]:e})};return D&&v.jsx(F.Item,{...a.props.formItem,"data-id":c,"data-type":l,children:v.jsx(w,{...a.props.formWrap,disabled:E,variant:a.props.formWrap.variant||void 0,options:x,style:a.style,onChange:e=>W(e)})})},X=r.forwardRef(C);export{X as default};
