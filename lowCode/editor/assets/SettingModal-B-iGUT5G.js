import{j as e,i as f,E as u,r as x,a as y,dW as S}from"./index-CY1Ymj4r.js";import{V as T}from"./VariableBind-g8cMkMZP.js";import{F as t}from"./index-BKDg-K48.js";import{I as l}from"./index-Du8QL6nv.js";import{R as r}from"./index-CrCWvzoA.js";import{R as w}from"./PlusOutlined-dRNvmZ2Y.js";import{R}from"./NotificationOutlined-C3CDmrw2.js";import{R as C}from"./InfoCircleOutlined-DWZ7nUzE.js";import{T as F}from"./index-BnlvMKaU.js";import{M as E}from"./index-ClLmsWSS.js";import{T as B}from"./index-Tz3gITLY.js";const k=function(){return e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{label:"接口ID",name:"id",hidden:!0,children:e.jsx(l,{})}),e.jsx(t.Item,{label:"接口名称",name:"name",rules:[{required:!0}],children:e.jsx(l,{placeholder:"请输入接口中文名称，eg: 用户列表",maxLength:20,showCount:!0})}),e.jsx(t.Item,{label:"请求方式",name:"method",children:e.jsxs(r.Group,{buttonStyle:"solid",children:[e.jsx(r.Button,{value:"GET",children:"GET"}),e.jsx(r.Button,{value:"POST",children:"POST"}),e.jsx(r.Button,{value:"PUT",children:"PUT"}),e.jsx(r.Button,{value:"PATCH",children:"PATCH"}),e.jsx(r.Button,{value:"DELETE",children:"DELETE"})]})}),e.jsx(t.Item,{label:"接口地址",extra:"支持模板语法：${id}，前提是事件流中有该字段。",children:e.jsxs(f,{direction:"vertical",style:{width:"100%"},children:[e.jsx(t.Item,{label:"STG地址",name:"stgApi",noStyle:!0,rules:[{required:!0}],children:e.jsx(l,{prefix:"STG：",placeholder:"https://mars-api.marsview.com.cn/api/xxx"})}),e.jsx(t.Item,{label:"PRE地址",name:"preApi",noStyle:!0,rules:[{required:!0}],children:e.jsx(l,{prefix:"PRE：",placeholder:"http://mars-api.marsview.com.cn/api/xxx"})}),e.jsx(t.Item,{label:"PRD地址",name:"prdApi",noStyle:!0,rules:[{required:!0}],children:e.jsx(l,{prefix:"PRD：",placeholder:"http://mars-api.marsview.com.cn/api/xxx"})})]})}),e.jsx(t.Item,{label:"数据格式",name:"contentType",children:e.jsxs(r.Group,{buttonStyle:"solid",children:[e.jsx(r.Button,{value:"application/json",children:"JSON"}),e.jsx(r.Button,{value:"multipart/form-data",children:"FormData"}),e.jsx(r.Button,{value:"application/x-www-form-urlencoded",children:"Form"})]})}),e.jsx(t.Item,{label:"发送参数",children:e.jsx(t.List,{name:"params",children:(n,{add:d,remove:m})=>e.jsx(e.Fragment,{children:n.map(({name:i},o)=>e.jsxs(f,{align:"baseline",style:{marginBottom:n.length===o+1?0:10,alignItems:"center"},children:[e.jsx(t.Item,{name:[i,"key"],noStyle:!0,children:e.jsx(l,{placeholder:"请输入参数名"})}),e.jsx(t.Item,{name:[i,"value"],noStyle:!0,children:e.jsx(T,{placeholder:"请输入参数值"})}),e.jsx(w,{onClick:()=>d({key:"",value:""})}),o>0&&e.jsx(R,{onClick:()=>{m(i)}})]},`header-${o}`))})})}),e.jsx(t.Item,{label:"参数替换",name:"replaceData",tooltip:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"1. 默认会把事件流参数和自定义参数合并；"}),e.jsx("p",{children:"2. 覆盖参数是事件流中上下文的参数覆盖自定义参数；"}),e.jsxs("p",{children:["3. 保留参数为只取自定义参数，参数支持模板语法：","${id}","。"]})]}),children:e.jsxs(r.Group,{buttonStyle:"solid",children:[e.jsx(r.Button,{value:"merge",children:"合并参数"}),e.jsx(r.Button,{value:"cover",children:"覆盖参数"}),e.jsx(r.Button,{value:"reserve",children:"保留参数"})]})}),e.jsx(t.Item,{label:"开启代理",name:"isCors",extra:"开启接口代理对解决跨域问题很有用",children:e.jsx(u,{})})]})},P=function(){return e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{lineHeight:"35px",color:"#5c5c5c",marginLeft:"70px",marginBottom:"10px"},children:[e.jsx(C,{}),e.jsxs("span",{style:{marginLeft:5},children:["用来定义接口返回结构，推荐结构：","{ code: 0, data: {}, msg: '' }"]})]}),e.jsx(t.Item,{label:"业务码",extra:"接口返回业务状态码，默认是：code",name:["result","code"],children:e.jsx(l,{placeholder:"默认为：code",maxLength:15,showCount:!0})}),e.jsx(t.Item,{label:"成功值",extra:"接口返回成功时对应的状态码值，默认是：0",name:["result","codeValue"],children:e.jsx(F,{placeholder:"默认为：0"})}),e.jsx(t.Item,{label:"结果字段",extra:"接口返回结果字段，默认是：data",name:["result","data"],children:e.jsx(l,{placeholder:"默认为：data",maxLength:15,showCount:!0})}),e.jsx(t.Item,{label:"报错字段",extra:"接口返回报错字段，默认是：msg",name:["result","msg"],children:e.jsx(l,{placeholder:"默认为：msg",maxLength:15,showCount:!0})})]})},A=function(){return e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{label:"默认成功提示",name:["tips","success"],children:e.jsx(l,{placeholder:"默认不提示",maxLength:50,showCount:!0})}),e.jsx(t.Item,{label:"默认失败提示",name:["tips","fail"],children:e.jsx(l,{placeholder:"默认不提示",maxLength:50,showCount:!0})}),e.jsx(t.Item,{label:"接口成功提示",name:["tips","isSuccess"],valuePropName:"checked",extra:"开启接口成功提示后，会优先使用接口返回成功信息。",children:e.jsx(u,{})}),e.jsx(t.Item,{label:"接口报错提示",name:["tips","isError"],valuePropName:"checked",extra:"开启接口报错提示后，会优先使用接口返回错误信息。",children:e.jsx(u,{})})]})},L=({update:n},d)=>{const{apis:m,addApi:i,updateApi:o}=y(s=>({apis:s.page.pageData.apis,addApi:s.addApi,updateApi:s.updateApi})),[a]=t.useForm(),[g,p]=x.useState(!1),h={method:"GET",url:"",sourceType:"json",params:[{key:"",value:""}],contentType:"application/json",replaceData:"merge",isCors:!0,result:{code:"code",data:"data",msg:"msg",codeValue:0},tips:{success:"请求成功",fail:"请求失败",isSuccess:!0,isError:!0}};x.useImperativeHandle(d,()=>({showModal:s=>{const c=s?m[s]:{};s?a.setFieldsValue({...c}):a.setFieldsValue({...h,...c}),p(!0)}}));const b=[{key:"base-set",label:"接口设置",forceRender:!0,children:e.jsx(k,{})},{key:"structure",label:"返回结构设置",forceRender:!0,children:e.jsx(P,{})},{key:"tips",label:"消息提示设置",forceRender:!0,children:e.jsx(A,{})}];async function I(){if(!await a.validateFields())return;const c=a.getFieldsValue();if(c.id)o(a.getFieldsValue());else{const v=S();i({...h,...a.getFieldsValue(),id:v})}n==null||n(c.id),j()}function j(){p(!1),a.resetFields()}return e.jsx(E,{width:"800px",okText:"确认",cancelText:"取消",title:"接口配置",open:g,onOk:I,onCancel:j,children:e.jsx(t,{form:a,labelCol:{span:4},wrapperCol:{span:19},style:{maxWidth:800},autoComplete:"off",children:e.jsx(B,{defaultActiveKey:"1",items:b})})})},J=x.forwardRef(L);export{J as S};
