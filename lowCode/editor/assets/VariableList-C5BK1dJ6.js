import{r as s,a as v,j as e,E as C,m as R,ah as S,B as w}from"./index-DmOc0qNU.js";import{l as B,F as T}from"./index-sNbwzaq7.js";import{F as i}from"./index-1_6nT-oA.js";import{M as L}from"./index-_pMv_sKm.js";import{I as x}from"./index-B-YUPJxN.js";import{R as n}from"./index-DxJl0Bxc.js";import{T as D}from"./index-o7l-rjNw.js";import{R as E}from"./PlusOutlined-BSTEPWl7.js";import{L as f}from"./index-CW6BFuNZ.js";import"./row-pIc0FM19.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./index-DOHCQObp.js";import"./BaseInput-4F0kfgVN.js";import"./TextArea-D7VuO_-I.js";import"./useVariants-BdxfBOl3.js";import"./EyeInvisibleOutlined-Cl_PTdo5.js";import"./EyeOutlined-QFSiY36E.js";import"./SearchOutlined-DscCkqW9.js";import"./index-B5-G8EA2.js";import"./DownOutlined-DnWdyoG8.js";import"./UpOutlined-CkYvBYD1.js";import"./extendsObject-keMuGWqj.js";import"./useShowArrow-CIjY5B73.js";import"./List-BV6fBbjc.js";import"./index-wVmnK_0F.js";import"./useIcons-CLAJNkrF.js";import"./useBreakpoint-Dj2PHoq7.js";import"./useForceUpdate-Y5LXbfsE.js";import"./Pagination-B_kLQQfV.js";import"./DoubleRightOutlined-FRvrxn3q.js";import"./index-DSaINUG7.js";const M=(m,p)=>{const[h,u]=s.useState(!1),[c,b]=s.useState("add"),[t,a]=s.useState("string"),d=s.useRef(null),[l]=i.useForm(),{theme:V,addVariable:y,editVariable:F}=v(r=>({theme:r.theme,variables:r.page.pageData.variables,addVariable:r.addVariable,editVariable:r.editVariable}));B.config({paths:{vs:"/static/monaco-editor/vs"}}),s.useImperativeHandle(p,()=>({open(r,o){r==="edit"&&(o.type==="array"||o.type==="object"?l.setFieldsValue({...o,defaultValue:JSON.stringify(o.defaultValue,null,4)}):l.setFieldsValue(o),a(o.type)),b(r),u(!0)}}));const I=r=>{a(r)},k=()=>{l.validateFields().then(()=>{var o;const r=l.getFieldsValue();if(t==="array"||t==="object"){const g=(o=d.current)==null?void 0:o.getValue();if(g)try{r.defaultValue=JSON.parse(g)}catch{R.error("请输入正确的json数据");return}}c==="add"?y(r):F(r),j()})},j=()=>{l.resetFields(),u(!1),a("string")};return e.jsx(L,{title:"添加变量",open:h,width:650,onOk:k,onCancel:j,okText:"提交",cancelText:"取消",children:e.jsxs(i,{form:l,labelCol:{span:6},wrapperCol:{span:16},initialValues:{type:"string"},children:[e.jsx(i.Item,{label:"变量名称",name:"name",rules:[{required:!0,message:"请输入变量名称"},{pattern:/^[a-zA-Z]\w{0,19}$/,message:"请输入正确的变量名称"}],children:e.jsx(x,{placeholder:"请输入变量名称，以字母开头，支持大小写、下划线",disabled:c=="edit",maxLength:20,showCount:!0})}),e.jsx(i.Item,{label:"变量类型",name:"type",rules:[{required:!0,message:"请选择变量类型"}],children:e.jsxs(n.Group,{buttonStyle:"solid",onChange:r=>I(r.target.value),children:[e.jsx(n.Button,{value:"string",children:"字符串"}),e.jsx(n.Button,{value:"number",children:"数字"}),e.jsx(n.Button,{value:"boolean",children:"布尔"}),e.jsx(n.Button,{value:"array",children:"数组"}),e.jsx(n.Button,{value:"object",children:"对象"})]})}),e.jsxs(i.Item,{label:"变量默认值",name:"defaultValue",rules:[{required:!0,message:"请输入变量值"}],children:[t==="string"&&e.jsx(x,{placeholder:"请输入变量值"}),t==="number"&&e.jsx(D,{placeholder:"请输入变量值",style:{width:"100%"}}),t==="boolean"&&e.jsx(C,{}),(t==="array"||t==="object")&&e.jsx(T,{height:"250px",language:"json",theme:V==="dark"?"vs-dark":"vs-light",options:{lineNumbers:"on",minimap:{enabled:!1}},onMount:r=>d.current=r})]}),e.jsx(i.Item,{label:"变量说明",name:"remark",children:e.jsx(x,{placeholder:"请输入变量说明",maxLength:20,showCount:!0})})]})})},N=s.forwardRef(M),be=()=>{const m=s.useRef(),{variables:p,removeVariable:h}=v(t=>({variables:t.page.pageData.variables,removeVariable:t.removeVariable})),u=()=>{var t;(t=m.current)==null||t.open("add")},c=(t,a)=>{var d;t.preventDefault(),(d=m.current)==null||d.open("edit",a)},b=(t,a)=>{t.preventDefault(),h(a)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{justify:"space-between",align:"center",style:{borderBottom:"1px solid var(--mars-theme-card-border-color)"},children:e.jsx(w,{type:"link",icon:e.jsx(E,{}),onClick:()=>u(),children:"新增"})}),e.jsx(f,{style:{height:"calc(100vh - 150px)",overflowY:"auto"},itemLayout:"horizontal",dataSource:p,renderItem:t=>e.jsx(f.Item,{actions:[e.jsx("a",{onClick:a=>c(a,t),children:"修改"}),e.jsx("a",{onClick:a=>b(a,t.name),children:"删除"})],children:e.jsx(f.Item.Meta,{title:`${t.name}`,description:t.remark})})}),e.jsx(N,{ref:m})]})};export{be as default};
