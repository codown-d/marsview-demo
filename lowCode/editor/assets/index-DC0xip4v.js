import{u as y,j as e,D as b,r as s,B as C,m as N,b as v,c as P,S as k,d as $}from"./index-DmOc0qNU.js";import{u as L,a as S,s as I,S as T}from"./index.module-BXHNkgSa.js";import{p as w}from"./project-RurpUGJo.js";import{C as F}from"./CreatePage-unumot6h.js";import{R as A}from"./RedoOutlined-C4rr1ZME.js";import{R as G}from"./UserOutlined-DAUrDjKa.js";import{R as H}from"./FolderOpenOutlined-Bj6jPccg.js";import{R as q,a as h}from"./MoreOutlined-C8o90ux3.js";import{A as z}from"./index-Df3uJrKd.js";import{T as E}from"./index-BytaExX6.js";import{R as B}from"./SettingOutlined-CGW_ik-t.js";import{T as D}from"./TextArea-D7VuO_-I.js";import{F as u}from"./index-1_6nT-oA.js";import{M}from"./index-_pMv_sKm.js";import{I as O}from"./index-B-YUPJxN.js";import{I as V}from"./index-jIBCjwxt.js";import{E as Q}from"./index-wVmnK_0F.js";import{R as X}from"./PlusOutlined-BSTEPWl7.js";import{P as J}from"./Pagination-B_kLQQfV.js";import"./debounce-CoSCf5Zb.js";import"./index-El1GW9WO.js";import"./isBrowser-CCWS3Xh9.js";import"./index-DSaINUG7.js";import"./useShowArrow-CIjY5B73.js";import"./List-BV6fBbjc.js";import"./useIcons-CLAJNkrF.js";import"./DownOutlined-DnWdyoG8.js";import"./SearchOutlined-DscCkqW9.js";import"./useVariants-BdxfBOl3.js";import"./row-pIc0FM19.js";import"./useBreakpoint-Dj2PHoq7.js";import"./useForceUpdate-Y5LXbfsE.js";import"./EditOutlined-D6nYSc60.js";import"./styleChecker-CQ-R2cXJ.js";import"./EnterOutlined-D0ebLqDC.js";import"./index-C0E5Fhz-.js";import"./CopyOutlined-BRIAy90h.js";import"./BaseInput-4F0kfgVN.js";import"./index-DOHCQObp.js";import"./QuestionCircleOutlined-Dza1yYuv.js";import"./EyeInvisibleOutlined-Cl_PTdo5.js";import"./EyeOutlined-QFSiY36E.js";import"./addEventListener-CKCD8Vpz.js";import"./ZoomOutOutlined-IpS0JADO.js";import"./DoubleRightOutlined-FRvrxn3q.js";const K="_container_1a5w9_1",U="_title_1a5w9_4",W="_projectGrid_1a5w9_9",Y="_projectCard_1a5w9_15",Z="_cardHeader_1a5w9_25",ee="_cardTitle_1a5w9_31",te="_cardIcon_1a5w9_37",oe="_cardContent_1a5w9_42",ae="_description_1a5w9_49",re="_metaInfo_1a5w9_57",se="_metaIcon_1a5w9_67",ne="_moreInfo_1a5w9_70",ie="_moreIcon_1a5w9_77",ce="_projectLogo_1a5w9_82",o={container:K,title:U,projectGrid:W,projectCard:Y,cardHeader:Z,cardTitle:ee,cardIcon:te,cardContent:oe,description:ae,metaInfo:re,metaIcon:se,moreInfo:ne,moreIcon:ie,projectLogo:ce},{Paragraph:me}=E;function le({list:a}){const n=y(),r=t=>{n(`/project/${t}/config`)},f=t=>{n(`/project/pages?projectId=${t}`)},m=[{key:"config",icon:e.jsx(B,{}),label:"项目配置"},{type:"divider"},{key:"stg",icon:e.jsx(h,{}),label:"测试环境"},{key:"pre",icon:e.jsx(h,{}),label:"预览环境"},{key:"prd",icon:e.jsx(h,{}),label:"生产环境"}],l=(t,i)=>t==="config"?r(i):window.open(`http://localhost:8090/project/${i}?env=${t}`,"_blank");return e.jsx(e.Fragment,{children:e.jsx("div",{className:o.projectGrid,children:a.map(t=>e.jsxs("div",{className:o.projectCard,children:[e.jsx("div",{className:o.cardHeader,onClick:()=>r(t.id),children:e.jsxs("h3",{className:o.cardTitle,children:[e.jsx(A,{className:o.cardIcon}),t.name]})}),e.jsxs("div",{className:o.cardContent,onClick:()=>f(t.id),children:[e.jsx(me,{className:o.description,children:t.remark}),e.jsxs("div",{className:o.metaInfo,children:[e.jsx(G,{className:o.metaIcon}),e.jsx("p",{children:t.userName})]}),e.jsxs("div",{className:o.metaInfo,children:[e.jsx(H,{className:o.metaIcon}),e.jsxs("p",{children:[e.jsxs("span",{children:[t.count," "]}),"个页面"]})]})]}),e.jsx("div",{className:o.moreInfo,children:e.jsx(b,{menu:{items:m,onClick:({key:i})=>l(i,t.id)},arrow:!0,placement:"bottomRight",trigger:["click"],children:e.jsx(q,{className:o.moreIcon})})}),e.jsx(z,{src:t.logo,className:o.projectLogo})]},t.id))})})}const de=(a,n)=>{const[r]=u.useForm(),[f,m]=s.useState(!1),[l,t]=s.useState(!1);s.useImperativeHandle(a.createRef,()=>({open(){r.resetFields(),m(!0)}}));const i=async()=>{var g;try{await r.validateFields();const p=r.getFieldsValue();t(!0),await w.addProject({...p}),N.success("项目初始化成功"),(g=a.update)==null||g.call(a),t(!1),m(!1)}catch{t(!1)}},d=()=>{r.resetFields(),m(!1)};return e.jsx(M,{title:"初始项目信息",open:f,confirmLoading:l,onCancel:d,width:500,footer:null,children:e.jsxs(u,{layout:"vertical",form:r,labelCol:{span:5},wrapperCol:{span:24},initialValues:{logo:"/imgs/mars-logo.png"},children:[e.jsx(u.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入页面名称"}],children:e.jsx(O,{placeholder:"请输入项目名称",maxLength:15,showCount:!0})}),e.jsx(u.Item,{label:"描述",name:"remark",rules:[{required:!0,message:"请输入描述"}],children:e.jsx(D,{autoSize:{minRows:4,maxRows:6},placeholder:"请输入描述",maxLength:100,showCount:!0})}),e.jsx(u.Item,{label:"图标",name:"logo",rules:[{required:!0,message:"请上传项目Logo"}],children:e.jsx(V,{width:100,src:"/imgs/mars-logo.png"})}),e.jsx(u.Item,{children:e.jsx(C,{block:!0,type:"primary",onClick:i,loading:l,children:"快速初始化"})})]})})},pe=s.memo(s.forwardRef(de));function ue(){const[a]=u.useForm(),[n,r]=s.useState("project"),[f]=v(),m=s.useRef(),l=s.useRef(),t=L({query:"(min-width: 1920px)"}),i=({current:c,pageSize:j},{keyword:R})=>(n==="project"?w.getCategoryList:$.getPageList)({pageNum:c,pageSize:j,keyword:R,projectId:Number(f.get("projectId"))}).then(_=>({total:_.total,list:_.list})),{tableProps:d,loading:g,search:p}=S(i,{form:a,defaultPageSize:t?15:12}),x=()=>{var c;(c=l.current)==null||c.open(n)};return e.jsxs(P.Content,{className:I.pageList,children:[e.jsx(T,{showGroup:!1,form:a,from:n==="project"?"项目":"页面",submit:p.submit,refresh:p.submit,onCreate:x}),n==="project"?e.jsx("div",{className:I.pagesContent,children:e.jsx(k,{spinning:g,size:"large",tip:"加载中...",children:d.dataSource.length>0?e.jsx(le,{list:d.dataSource}):e.jsx(Q,{style:{marginTop:100},children:e.jsx(C,{type:"dashed",icon:e.jsx(X,{}),onClick:x,children:"创建项目"})})})}):null,d.dataSource.length>0?e.jsx(J,{...d.pagination,onChange:(c,j)=>d.onChange({current:c,pageSize:j}),showSizeChanger:!0,showTotal:c=>`总共 ${c} 条`,align:"end"}):null,e.jsx(pe,{createRef:l,update:p.submit}),e.jsx(F,{createRef:m,update:p.submit})]})}const nt=s.memo(ue);export{nt as default};
